---------------- start ----------------
Sat Oct  1 10:51:33 CEST 2016
max threads: 2
max memory: 19000 MB
time limit: 26 hours
gpu device id: 0
.VGGface_MVS-train.sh.1  1
---------------------------------------

This is VGGface_MVS-train5.py
Using gpu device 0: GeForce GTX TITAN X (CNMeM is enabled with initial size: 95.0% of memory, cuDNN 4007)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
VGGface_MVS-train5.py:247: UserWarning: The parameter 'updates' of theano.function() expects an OrderedDict, got <type 'dict'>. Using a standard dictionary here results in non-deterministic behavior. You should use an OrderedDict if you are using Python 2.7 (theano.compat.OrderedDict for older python), or use a list of (shared, update) pairs. Do not just convert your dictionary to this type before the call as the conversion will still be non-deterministic.
  get_dist_from_feature_embed(feature_embed), updates=updates)
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.003, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 0.01
============ epoch 0 ===========
training loss:		0.017833
||Xanchor-Xpos||_2  counter: 
[  617  9385 24239 34551 35930 32002 24824 17284 10789  5916  3145  1443
   626   269   111    53    12     6     5     2]
||Xanchor-Xneg||_2  counter: 
[  299  6042 19372 31889 36009 33302 27245 19437 12741  7496  4063  1926
   836   316   136    63    25     7     3     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  16.86541748   43.8802948    70.89517212   97.91004944  124.92492676
  151.93980408  178.9546814   205.96955872  232.98443604  259.99931335
  287.01419067  314.02906799  341.04394531  368.05882263  395.07369995
  422.08857727  449.10345459  476.11833191  503.13320923  530.14808655
  557.16296387]
distance difference  counter: 
(array([    1,     0,     1,     2,     3,     9,     4,    12,    30,
          38,    92,   143,   293,   729,  1665,  4409, 15498, 92392,
       83070,  2818]), array([-7.62594748, -7.20156561, -6.77718374, -6.35280187, -5.92842001,
       -5.50403814, -5.07965627, -4.65527441, -4.23089254, -3.80651067,
       -3.3821288 , -2.95774694, -2.53336507, -2.1089832 , -1.68460134,
       -1.26021947, -0.8358376 , -0.41145574,  0.01292613,  0.437308  ,
        0.86168987]))
||Xanchor-Xpos||_2  counter: 
[1137 3439 5024 6264 6599 5998 5058 3568 2533 1612  948  556  315  163   69
   26   18   12    6    2]
||Xanchor-Xneg||_2  counter: 
[ 611 2473 3964 5194 6011 6255 5452 4186 3249 2256 1506  960  581  333  156
  100   30   19    9    5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  10.92004204   26.58850069   42.25695934   57.925418     73.59387665
   89.2623353   104.93079395  120.59925261  136.26771126  151.93616991
  167.60462856  183.27308722  198.94154587  214.61000452  230.27846317
  245.94692183  261.61538048  277.28383913  292.95229778  308.62075644
  324.28921509]
distance difference  counter: 
(array([    2,     1,     0,     0,     3,     0,     3,     4,    12,
          21,    44,    80,   148,   310,   651,  1573,  4716, 18673,
       16093,  1016]), array([-7.87767887, -7.43955157, -7.00142426, -6.56329696, -6.12516966,
       -5.68704236, -5.24891505, -4.81078775, -4.37266045, -3.93453314,
       -3.49640584, -3.05827854, -2.62015123, -2.18202393, -1.74389663,
       -1.30576932, -0.86764202, -0.42951472,  0.00861259,  0.44673989,
        0.88486719]))
train/val Accuracy = 0.527297486693 / 0.521026528258 
 with threshold: [[ 160.27464012]]
============ epoch 1 ===========
training loss:		0.017811
||Xanchor-Xpos||_2  counter: 
[  952 10752 24598 34165 35247 30967 24444 17020 10711  6306  3249  1560
   695   335   130    46    27     2     2     1]
||Xanchor-Xneg||_2  counter: 
[  473  6973 20252 31636 34853 32637 26614 19280 12797  7897  4125  2022
   960   415   177    53    29     9     6     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  20.36722183   46.56217556   72.75712929   98.95208302  125.14703674
  151.34199047  177.5369442   203.73189793  229.92685165  256.12180538
  282.31675911  308.51171284  334.70666656  360.90162029  387.09657402
  413.29152775  439.48648148  465.6814352   491.87638893  518.07134266
  544.26629639]
distance difference  counter: 
(array([     2,      0,      0,      1,      2,      6,      6,     21,
           19,     38,     71,    170,    357,    773,   1713,   4687,
        16643, 100351,  73968,   2381]), array([-7.57977295, -7.15683145, -6.73388996, -6.31094846, -5.88800696,
       -5.46506546, -5.04212397, -4.61918247, -4.19624097, -3.77329948,
       -3.35035798, -2.92741648, -2.50447499, -2.08153349, -1.65859199,
       -1.23565049, -0.812709  , -0.3897675 ,  0.033174  ,  0.45611549,
        0.87905699]))
||Xanchor-Xpos||_2  counter: 
[1399 3934 5770 6935 7048 6140 4549 3162 1972 1160  643  326  169   80   26
   19    8    5    1    2]
||Xanchor-Xneg||_2  counter: 
[ 761 2907 4616 5903 6867 6450 5123 3916 2760 1726 1051  608  366  169   68
   33   17    4    3    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  10.83337879   27.72442164   44.6154645    61.50650735   78.3975502
   95.28859305  112.17963591  129.07067876  145.96172161  162.85276446
  179.74380732  196.63485017  213.52589302  230.41693587  247.30797873
  264.19902158  281.09006443  297.98110728  314.87215014  331.76319299
  348.65423584]
distance difference  counter: 
(array([    1,     3,     0,     0,     3,     2,     0,     7,    12,
          23,    43,    85,   147,   305,   658,  1724,  4770, 19257,
       15344,   966]), array([-7.76875734, -7.33606486, -6.90337238, -6.4706799 , -6.03798742,
       -5.60529494, -5.17260246, -4.73990998, -4.3072175 , -3.87452502,
       -3.44183254, -3.00914006, -2.57644758, -2.1437551 , -1.71106262,
       -1.27837014, -0.84567766, -0.41298518,  0.0197073 ,  0.45239978,
        0.88509226]))
train/val Accuracy = 0.527011714188 / 0.520599769319 
 with threshold: [[ 159.06702223]]
============ epoch 2 ===========
training loss:		0.017789
||Xanchor-Xpos||_2  counter: 
[  896 10177 23844 33539 34273 31424 24690 17418 11424  6699  3624  1740
   830   354   166    65    33     8     2     2]
||Xanchor-Xneg||_2  counter: 
[  441  6669 19455 30496 34620 32236 26892 19933 13377  8356  4476  2357
  1109   458   202    72    35    16     5     4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  20.22896767   45.80923681   71.38950596   96.9697751   122.55004425
  148.1303134   173.71058254  199.29085169  224.87112083  250.45138998
  276.03165913  301.61192827  327.19219742  352.77246656  378.35273571
  403.93300486  429.513274    455.09354315  480.67381229  506.25408144
  531.83435059]
distance difference  counter: 
(array([     1,      0,      0,      3,      1,      2,      3,      9,
           12,     29,     49,    110,    225,    543,   1218,   3514,
        12333,  80317, 100111,   2729]), array([-8.4205389 , -7.95411432, -7.48768974, -7.02126516, -6.55484058,
       -6.088416  , -5.62199141, -5.15556683, -4.68914225, -4.22271767,
       -3.75629309, -3.28986851, -2.82344393, -2.35701934, -1.89059476,
       -1.42417018, -0.9577456 , -0.49132102, -0.02489644,  0.44152814,
        0.90795273]))
||Xanchor-Xpos||_2  counter: 
[1259 3619 5122 6395 6605 6072 4940 3469 2395 1548  861  502  285  135   72
   34   18   12    3    2]
||Xanchor-Xneg||_2  counter: 
[ 701 2609 4044 5282 6208 6247 5401 4068 3186 2228 1383  865  549  294  153
   73   26   21   10    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  11.33111095   26.9176621    42.50421324   58.09076438   73.67731552
   89.26386666  104.8504178   120.43696895  136.02352009  151.61007123
  167.19662237  182.78317351  198.36972466  213.9562758   229.54282694
  245.12937808  260.71592922  276.30248036  291.88903151  307.47558265
  323.06213379]
distance difference  counter: 
(array([    1,     0,     2,     0,     2,     4,     2,     2,     8,
          17,    34,    71,   137,   262,   586,  1504,  4290, 17385,
       17978,  1065]), array([-8.12878036, -7.67798306, -7.22718575, -6.77638844, -6.32559114,
       -5.87479383, -5.42399652, -4.97319921, -4.52240191, -4.0716046 ,
       -3.62080729, -3.17000998, -2.71921268, -2.26841537, -1.81761806,
       -1.36682075, -0.91602345, -0.46522614, -0.01442883,  0.43636848,
        0.88716578]))
train/val Accuracy = 0.526996804318 / 0.521234140715 
 with threshold: [[ 157.82789723]]
============ epoch 3 ===========
training loss:		0.017767
||Xanchor-Xpos||_2  counter: 
[  956 11145 25382 34498 35297 31233 23846 16849 10497  5875  3004  1493
   633   289   131    48    26     2     2     3]
||Xanchor-Xneg||_2  counter: 
[  499  7198 20984 32135 35255 32528 26343 18985 12551  7309  3984  1931
   872   398   140    60    23     9     3     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  20.27994347   46.27504053   72.2701376    98.26523466  124.26033173
  150.25542879  176.25052586  202.24562292  228.24071999  254.23581705
  280.23091412  306.22601118  332.22110825  358.21620531  384.21130238
  410.20639944  436.20149651  462.19659357  488.19169064  514.1867877
  540.18188477]
distance difference  counter: 
(array([     2,      1,      4,      7,      8,      7,     14,     23,
           38,    101,    118,    246,    486,   1072,   2414,   6409,
        22485, 114675,  51183,   1916]), array([-6.84225321, -6.45713415, -6.0720151 , -5.68689605, -5.30177699,
       -4.91665794, -4.53153889, -4.14641983, -3.76130078, -3.37618172,
       -2.99106267, -2.60594362, -2.22082456, -1.83570551, -1.45058646,
       -1.0654674 , -0.68034835, -0.29522929,  0.08988976,  0.47500881,
        0.86012787]))
||Xanchor-Xpos||_2  counter: 
[1411 3858 5704 6717 6942 6028 4685 3237 2101 1206  741  348  206   82   36
   27   10    6    3    1]
||Xanchor-Xneg||_2  counter: 
[ 786 2845 4485 5766 6684 6224 5246 3952 2891 1856 1193  681  387  196   94
   37   14    7    3    3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  11.2418642    27.49705005   43.75223589   60.00742173   76.26260757
   92.51779342  108.77297926  125.0281651   141.28335094  157.53853679
  173.79372263  190.04890847  206.30409431  222.55928016  238.814466
  255.06965184  271.32483768  287.58002353  303.83520937  320.09039521
  336.34558105]
distance difference  counter: 
(array([    1,     1,     1,     0,     5,     1,     1,     8,    16,
          24,    37,    79,   166,   308,   650,  1661,  4758, 19006,
       15610,  1017]), array([-7.78517151, -7.35188545, -6.91859939, -6.48531332, -6.05202726,
       -5.6187412 , -5.18545514, -4.75216908, -4.31888301, -3.88559695,
       -3.45231089, -3.01902483, -2.58573877, -2.1524527 , -1.71916664,
       -1.28588058, -0.85259452, -0.41930846,  0.01397761,  0.44726367,
        0.88054973]))
train/val Accuracy = 0.526457564025 / 0.521361014994 
 with threshold: [[ 156.55201005]]
============ epoch 4 ===========
training loss:		0.017745
||Xanchor-Xpos||_2  counter: 
[  980 11498 26474 35800 35840 31203 23692 16109  9696  5189  2610  1202
   558   221    72    38    21     4     1     1]
||Xanchor-Xneg||_2  counter: 
[  499  7683 21749 33412 36267 32503 26184 18334 11847  6550  3455  1549
   703   280   131    45     8     6     2     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  19.35391426   45.82805815   72.30220203   98.77634592  125.25048981
  151.72463369  178.19877758  204.67292147  231.14706535  257.62120924
  284.09535313  310.56949701  337.0436409   363.51778479  389.99192867
  416.46607256  442.94021645  469.41436033  495.88850422  522.36264811
  548.83679199]
distance difference  counter: 
(array([     1,      0,      0,      0,      1,      3,      5,      8,
           16,     23,     47,    105,    233,    478,   1165,   3218,
        11337,  69123, 111687,   3759]), array([-8.45738411, -7.9906266 , -7.5238691 , -7.05711159, -6.59035408,
       -6.12359658, -5.65683907, -5.19008157, -4.72332406, -4.25656655,
       -3.78980905, -3.32305154, -2.85629404, -2.38953653, -1.92277902,
       -1.45602152, -0.98926401, -0.52250651, -0.055749  ,  0.41100851,
        0.87776601]))
||Xanchor-Xpos||_2  counter: 
[1577 4025 5901 7050 7046 5985 4437 3037 1934 1152  619  309  143   74   29
   17    6    6    2    0]
||Xanchor-Xneg||_2  counter: 
[ 889 2996 4708 6005 6878 6311 5030 3884 2715 1670 1047  602  337  159   66
   23   20    5    3    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  11.41363525   27.9445755    44.47551575   61.00645599   77.53739624
   94.06833649  110.59927673  127.13021698  143.66115723  160.19209747
  176.72303772  193.25397797  209.78491821  226.31585846  242.84679871
  259.37773895  275.9086792   292.43961945  308.97055969  325.50149994
  342.03244019]
distance difference  counter: 
(array([    1,     1,     0,     1,     1,     2,     4,     5,     9,
          22,    34,    67,   135,   255,   572,  1520,  4420, 17604,
       17660,  1037]), array([-8.13782501, -7.68623932, -7.23465363, -6.78306794, -6.33148226,
       -5.87989657, -5.42831088, -4.97672519, -4.5251395 , -4.07355381,
       -3.62196812, -3.17038243, -2.71879674, -2.26721105, -1.81562536,
       -1.36403967, -0.91245399, -0.4608683 , -0.00928261,  0.44230308,
        0.89388877]))
train/val Accuracy = 0.527232877257 / 0.520542099193 
 with threshold: [[ 155.35736457]]
untile now, the train_val_mean_acc: [0.52416200747565167]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.003, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 0.1
============ epoch 0 ===========
training loss:		0.177033
||Xanchor-Xpos||_2  counter: 
[  728  9740 24514 34071 35101 31252 24757 17309 10958  6360  3375  1694
   764   348   152    52    23     3     1     5]
||Xanchor-Xneg||_2  counter: 
[  399  6239 19997 31717 35292 32617 26529 19388 13023  7852  4293  2113
  1008   440   182    72    36    10     0     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  18.17225838   43.77425947   69.37626057   94.97826166  120.58026276
  146.18226385  171.78426495  197.38626604  222.98826714  248.59026823
  274.19226933  299.79427042  325.39627151  350.99827261  376.6002737
  402.2022748   427.80427589  453.40627699  479.00827808  504.61027918
  530.21228027]
distance difference  counter: 
(array([     1,      2,      1,      4,      6,      3,     10,     28,
           30,     68,    140,    234,    468,   1061,   2324,   6427,
        23485, 114747,  50380,   1790]), array([-6.78762817, -6.40515972, -6.02269127, -5.64022282, -5.25775437,
       -4.87528592, -4.49281747, -4.11034902, -3.72788057, -3.34541212,
       -2.96294367, -2.58047522, -2.19800677, -1.81553832, -1.43306987,
       -1.05060142, -0.66813297, -0.28566452,  0.09680393,  0.47927238,
        0.86174083]))
||Xanchor-Xpos||_2  counter: 
[1222 3478 5071 6291 6554 5968 4913 3743 2503 1563  989  555  282  126   59
   19    8    5    1    0]
||Xanchor-Xneg||_2  counter: 
[ 682 2430 4091 5392 6085 6086 5392 4298 3201 2179 1440  928  572  296  161
   73   28    8    6    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  10.96811962   25.55634236   40.14456511   54.73278785   69.32101059
   83.90923333   98.49745607  113.08567882  127.67390156  142.2621243
  156.85034704  171.43856978  186.02679253  200.61501527  215.20323801
  229.79146075  244.37968349  258.96790624  273.55612898  288.14435172
  302.73257446]
distance difference  counter: 
(array([    2,     1,     0,     3,     5,     6,     9,    14,    31,
          45,    86,   133,   246,   536,  1068,  2720,  7774, 22694,
        7454,   523]), array([-6.56301641, -6.1903279 , -5.81763939, -5.44495088, -5.07226237,
       -4.69957386, -4.32688535, -3.95419684, -3.58150833, -3.20881982,
       -2.8361313 , -2.46344279, -2.09075428, -1.71806577, -1.34537726,
       -0.97268875, -0.60000024, -0.22731173,  0.14537678,  0.51806529,
        0.89075381]))
train/val Accuracy = 0.525140525523 / 0.518131487889 
 with threshold: [[ 154.7471166]]
============ epoch 1 ===========
training loss:		0.175080
||Xanchor-Xpos||_2  counter: 
[  815 10494 25639 34801 35408 31147 24145 16798 10365  5717  3174  1526
   686   275   126    60    19    11     3     0]
||Xanchor-Xneg||_2  counter: 
[  445  6915 21057 32663 35363 32732 26204 18956 12191  7451  3786  1957
   845   372   156    71    27    12     4     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  17.31544495   41.23462296   65.15380096   89.07297897  112.99215698
  136.91133499  160.830513    184.74969101  208.66886902  232.58804703
  256.50722504  280.42640305  304.34558105  328.26475906  352.18393707
  376.10311508  400.02229309  423.9414711   447.86064911  471.77982712
  495.69900513]
distance difference  counter: 
(array([     2,      2,      4,      4,      5,      6,     18,     31,
           48,     63,    154,    275,    619,   1244,   2909,   7893,
        29892, 121762,  35108,   1170]), array([-6.49633789, -6.12719971, -5.75806152, -5.38892334, -5.01978515,
       -4.65064697, -4.28150879, -3.9123706 , -3.54323242, -3.17409423,
       -2.80495605, -2.43581786, -2.06667968, -1.6975415 , -1.32840331,
       -0.95926513, -0.59012694, -0.22098876,  0.14814942,  0.51728761,
        0.88642579]))
||Xanchor-Xpos||_2  counter: 
[ 909 3205 4514 6029 6387 5926 5116 4028 2804 1883 1153  678  374  202   69
   44   19    7    3    0]
||Xanchor-Xneg||_2  counter: 
[ 450 2193 3657 5099 5794 5814 5553 4581 3418 2503 1687 1088  709  381  232
  112   51   20    6    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   8.88500309   21.9275846    34.97016611   48.01274762   61.05532913
   74.09791064   87.14049215  100.18307366  113.22565517  126.26823668
  139.3108182   152.35339971  165.39598122  178.43856273  191.48114424
  204.52372575  217.56630726  230.60888877  243.65147028  256.69405179
  269.7366333 ]
distance difference  counter: 
(array([    2,     1,     1,     0,     7,     3,    11,    11,    16,
          41,    65,   148,   230,   508,  1003,  2598,  7265, 22607,
        8249,   584]), array([-6.67074203, -6.29289069, -5.91503934, -5.537188  , -5.15933665,
       -4.7814853 , -4.40363396, -4.02578261, -3.64793127, -3.27007992,
       -2.89222857, -2.51437723, -2.13652588, -1.75867454, -1.38082319,
       -1.00297184, -0.6251205 , -0.24726915,  0.1305822 ,  0.50843354,
        0.88628489]))
train/val Accuracy = 0.525995358061 / 0.518512110727 
 with threshold: [[ 142.74176399]]
============ epoch 2 ===========
training loss:		0.173419
||Xanchor-Xpos||_2  counter: 
[  719  8689 22410 32291 33888 30944 25302 18525 12385  7530  4205  2230
  1149   527   216   110    48    29     9     2]
||Xanchor-Xneg||_2  counter: 
[  348  5719 18016 29482 33424 32228 27027 20734 14426  9011  5274  2943
  1381   691   287   109    59    32    13     5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  16.17042923   37.00534039   57.84025154   78.6751627    99.51007385
  120.34498501  141.17989616  162.01480732  182.84971848  203.68462963
  224.51954079  245.35445194  266.1893631   287.02427425  307.85918541
  328.69409657  349.52900772  370.36391888  391.19883003  412.03374119
  432.86865234]
distance difference  counter: 
(array([    1,     1,     2,     0,     3,     4,     4,    20,    24,
          39,    79,   143,   308,   722,  1718,  4625, 16300, 96048,
       78427,  2741]), array([-7.45399714, -7.0383272 , -6.62265726, -6.20698732, -5.79131738,
       -5.37564744, -4.9599775 , -4.54430756, -4.12863762, -3.71296768,
       -3.29729775, -2.88162781, -2.46595787, -2.05028793, -1.63461799,
       -1.21894805, -0.80327811, -0.38760817,  0.02806177,  0.4437317 ,
        0.85940164]))
||Xanchor-Xpos||_2  counter: 
[ 854 3170 4462 6006 6161 5913 5222 4040 2852 1884 1234  771  396  222   89
   42   21    7    4    0]
||Xanchor-Xneg||_2  counter: 
[ 452 2163 3541 4985 5695 5836 5514 4603 3481 2577 1710 1143  738  438  239
  139   65   19   10    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   8.1942358    20.09996743   32.00569906   43.91143069   55.81716232
   67.72289395   79.62862558   91.53435721  103.44008884  115.34582047
  127.2515521   139.15728374  151.06301537  162.968747    174.87447863
  186.78021026  198.68594189  210.59167352  222.49740515  234.40313678
  246.30886841]
distance difference  counter: 
(array([    3,     2,     6,     0,     6,    10,    12,    31,    44,
          61,   111,   210,   366,   765,  1493,  3637, 10055, 21251,
        4880,   407]), array([-5.8529315 , -5.51583788, -5.17874426, -4.84165064, -4.50455701,
       -4.16746339, -3.83036977, -3.49327615, -3.15618253, -2.81908891,
       -2.48199528, -2.14490166, -1.80780804, -1.47071442, -1.1336208 ,
       -0.79652718, -0.45943356, -0.12233993,  0.21475369,  0.55184731,
        0.88894093]))
train/val Accuracy = 0.525856199275 / 0.517647058824 
 with threshold: [[ 131.64229314]]
============ epoch 3 ===========
training loss:		0.172007
||Xanchor-Xpos||_2  counter: 
[  919 11461 27470 36514 36253 31203 23238 15411  9183  5092  2473  1169
   485   200    80    35    14     5     2     2]
||Xanchor-Xneg||_2  counter: 
[  444  7719 22862 34362 37012 32585 25389 17681 11220  6224  3173  1461
   649   251   104    51    18     0     2     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  14.3980875    35.48792892   56.57777033   77.66761174   98.75745316
  119.84729457  140.93713598  162.0269774   183.11681881  204.20666022
  225.29650164  246.38634305  267.47618446  288.56602588  309.65586729
  330.7457087   351.83555012  372.92539153  394.01523294  415.10507436
  436.19491577]
distance difference  counter: 
(array([     1,      0,      0,      0,      1,      1,      0,      1,
            5,      7,     32,     38,     89,    250,    661,   1824,
         6700,  40873, 144183,   6543]), array([-9.74599743, -9.21438555, -8.68277367, -8.15116179, -7.61954991,
       -7.08793803, -6.55632614, -6.02471426, -5.49310238, -4.9614905 ,
       -4.42987862, -3.89826674, -3.36665486, -2.83504298, -2.3034311 ,
       -1.77181922, -1.24020734, -0.70859546, -0.17698358,  0.3546283 ,
        0.88624018]))
||Xanchor-Xpos||_2  counter: 
[ 966 3420 5049 6345 6516 6023 5145 3739 2445 1664  992  551  280  116   61
   21   10    6    1    0]
||Xanchor-Xneg||_2  counter: 
[ 530 2356 4014 5351 6070 6124 5506 4397 3223 2216 1511  895  600  293  149
   84   17    9    3    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   7.55716658   19.11863396   30.68010135   42.24156873   53.80303612
   65.3645035    76.92597089   88.48743827  100.04890566  111.61037304
  123.17184043  134.73330781  146.2947752   157.85624259  169.41770997
  180.97917736  192.54064474  204.10211213  215.66357951  227.2250469
  238.78651428]
distance difference  counter: 
(array([    1,     2,     0,     2,     3,     5,     6,    15,    24,
          40,    66,   132,   244,   510,  1058,  2603,  7573, 22786,
        7744,   536]), array([-6.58588791, -6.21201602, -5.83814414, -5.46427225, -5.09040036,
       -4.71652848, -4.34265659, -3.9687847 , -3.59491282, -3.22104093,
       -2.84716904, -2.47329715, -2.09942527, -1.72555338, -1.35168149,
       -0.97780961, -0.60393772, -0.23006583,  0.14380605,  0.51767794,
        0.89154983]))
train/val Accuracy = 0.525379083441 / 0.518731257209 
 with threshold: [[ 121.50086284]]
============ epoch 4 ===========
training loss:		0.170806
||Xanchor-Xpos||_2  counter: 
[  682 10992 28075 37519 37518 31665 22812 15139  8586  4540  2088   907
   434   167    53    20     5     5     1     1]
||Xanchor-Xneg||_2  counter: 
[  344  7211 23279 35629 37932 33148 25415 17422 10322  5762  2741  1197
   491   191    76    28    13     5     2     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  11.25810528   31.3717381    51.48537092   71.59900374   91.71263657
  111.82626939  131.93990221  152.05353503  172.16716785  192.28080068
  212.3944335   232.50806632  252.62169914  272.73533196  292.84896479
  312.96259761  333.07623043  353.18986325  373.30349607  393.4171289
  413.53076172]
distance difference  counter: 
(array([     1,      0,      0,      0,      2,      1,      3,      7,
            9,     11,     31,     75,    133,    356,    825,   2514,
         8835,  53443, 129799,   5164]), array([-8.89552593, -8.40735669, -7.91918744, -7.43101819, -6.94284894,
       -6.4546797 , -5.96651045, -5.4783412 , -4.99017196, -4.50200271,
       -4.01383346, -3.52566422, -3.03749497, -2.54932572, -2.06115648,
       -1.57298723, -1.08481798, -0.59664873, -0.10847949,  0.37968976,
        0.86785901]))
||Xanchor-Xpos||_2  counter: 
[1183 3280 4876 5979 6375 5818 5075 3832 2707 1772 1129  642  353  186   77
   38   18    4    6    0]
||Xanchor-Xneg||_2  counter: 
[ 640 2316 3874 5122 5773 5932 5441 4375 3389 2317 1619 1100  661  373  235
  105   50   15    5    7]
||Xanchor-X_neg/pos||_2  bins edge: 
[   8.12970352   18.36299191   28.59628029   38.82956867   49.06285706
   59.29614544   69.52943382   79.76272221   89.99601059  100.22929897
  110.46258736  120.69587574  130.92916412  141.16245251  151.39574089
  161.62902927  171.86231766  182.09560604  192.32889442  202.56218281
  212.79547119]
distance difference  counter: 
(array([    1,     2,     0,     2,     1,     1,     6,     5,    17,
          23,    36,    85,   153,   323,   696,  1753,  5306, 20757,
       13361,   822]), array([-7.51503944, -7.09438488, -6.67373031, -6.25307575, -5.83242118,
       -5.41176662, -4.99111205, -4.57045749, -4.14980292, -3.72914836,
       -3.30849379, -2.88783923, -2.46718466, -2.0465301 , -1.62587553,
       -1.20522097, -0.7845664 , -0.36391184,  0.05674273,  0.47739729,
        0.89805186]))
train/val Accuracy = 0.525791589839 / 0.51875432526 
 with threshold: [[ 112.18573199]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.003, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 1
============ epoch 0 ===========
training loss:		1.709965
||Xanchor-Xpos||_2  counter: 
[ 2843 26444 45356 44211 33019 21528 12797  7308  3947  2005   959   457
   205    74    33    13     6     4     0     0]
||Xanchor-Xneg||_2  counter: 
[ 1704 20739 42613 44190 35012 23985 14735  8644  4787  2538  1241   561
   264   117    47    17     8     3     3     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   7.74242783   33.57644291   59.41045799   85.24447308  111.07848816
  136.91250324  162.74651833  188.58053341  214.41454849  240.24856358
  266.08257866  291.91659374  317.75060883  343.58462391  369.41863899
  395.25265408  421.08666916  446.92068424  472.75469933  498.58871441
  524.42272949]
distance difference  counter: 
(array([    1,     1,     0,     1,     2,     2,     7,     8,    19,
          33,    63,   128,   254,   599,  1460,  3866, 13820, 85410,
       92663,  2872]), array([ -7.99410200e+00,  -7.55007778e+00,  -7.10605356e+00,
        -6.66202934e+00,  -6.21800512e+00,  -5.77398090e+00,
        -5.32995668e+00,  -4.88593246e+00,  -4.44190824e+00,
        -3.99788402e+00,  -3.55385980e+00,  -3.10983558e+00,
        -2.66581136e+00,  -2.22178714e+00,  -1.77776292e+00,
        -1.33373870e+00,  -8.89714479e-01,  -4.45690259e-01,
        -1.66603923e-03,   4.42358181e-01,   8.86382401e-01]))
||Xanchor-Xpos||_2  counter: 
[1331 3642 5374 6513 6713 6037 4711 3441 2295 1409  863  488  288  127   69
   24   16    5    0    2]
||Xanchor-Xneg||_2  counter: 
[ 731 2724 4205 5618 6225 6223 5204 4047 3010 1989 1351  874  514  304  186
   85   37   12    9    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   4.94309998   12.30806808   19.67303619   27.0380043    34.40297241
   41.76794052   49.13290863   56.49787674   63.86284485   71.22781296
   78.59278107   85.95774918   93.32271729  100.68768539  108.0526535
  115.41762161  122.78258972  130.14755783  137.51252594  144.87749405
  152.24246216]
distance difference  counter: 
(array([    2,     2,     0,     1,    11,     5,    11,    17,    27,
          62,   109,   181,   313,   622,  1250,  3079,  8679, 22128,
        6321,   530]), array([-6.00847435, -5.66400796, -5.31954157, -4.97507518, -4.63060879,
       -4.28614239, -3.941676  , -3.59720961, -3.25274322, -2.90827683,
       -2.56381044, -2.21934405, -1.87487766, -1.53041126, -1.18594487,
       -0.84147848, -0.49701209, -0.1525457 ,  0.19192069,  0.53638708,
        0.88085347]))
train/val Accuracy = 0.523502924819 / 0.501637831603 
 with threshold: [[ 111.73051697]]
============ epoch 1 ===========
training loss:		1.653167
||Xanchor-Xpos||_2  counter: 
[ 3828 28487 45313 43234 32124 20888 12645  7133  3837  1962   964   456
   203    74    38    11     9     2     0     1]
||Xanchor-Xneg||_2  counter: 
[ 2365 22722 42541 43666 34285 23221 14607  8431  4584  2471  1292   597
   240   114    41    23     5     3     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   4.39332438   15.80619447   27.21906457   38.63193467   50.04480476
   61.45767486   72.87054496   84.28341506   95.69628515  107.10915525
  118.52202535  129.93489544  141.34776554  152.76063564  164.17350574
  175.58637583  186.99924593  198.41211603  209.82498612  221.23785622
  232.65072632]
distance difference  counter: 
(array([     2,      4,      3,      2,      6,     11,     19,     32,
           67,    110,    219,    338,    755,   1561,   3429,   9430,
        35025, 121395,  27649,   1152]), array([-5.89936352, -5.5605152 , -5.22166689, -4.88281858, -4.54397026,
       -4.20512195, -3.86627364, -3.52742532, -3.18857701, -2.84972869,
       -2.51088038, -2.17203207, -1.83318375, -1.49433544, -1.15548713,
       -0.81663881, -0.4777905 , -0.13894219,  0.19990613,  0.53875444,
        0.87760276]))
||Xanchor-Xpos||_2  counter: 
[1631 3976 5725 7010 6911 5843 4530 3079 1970 1212  715  375  197   91   47
   20   13    2    1    0]
||Xanchor-Xneg||_2  counter: 
[ 924 3058 4586 6004 6532 6253 4965 3872 2678 1773 1148  685  423  250  113
   45   22   14    3    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  2.37546134   5.80296704   9.23047273  12.65797843  16.08548412
  19.51298982  22.94049551  26.36800121  29.79550691  33.2230126
  36.6505183   40.07802399  43.50552969  46.93303539  50.36054108
  53.78804678  57.21555247  60.64305817  64.07056386  67.49806956
  70.92557526]
distance difference  counter: 
(array([    1,     2,     2,     2,     3,     8,     9,    21,    28,
          73,   111,   191,   339,   700,  1525,  3716, 10587, 20531,
        5044,   457]), array([-5.21260834, -4.90758056, -4.60255278, -4.29752501, -3.99249723,
       -3.68746945, -3.38244168, -3.0774139 , -2.77238612, -2.46735834,
       -2.16233057, -1.85730279, -1.55227501, -1.24724724, -0.94221946,
       -0.63719168, -0.33216391, -0.02713613,  0.27789165,  0.58291942,
        0.8879472 ]))
train/val Accuracy = 0.523880641522 / 0.501510957324 
 with threshold: [[ 49.70509928]]
============ epoch 2 ===========
training loss:		1.642001
||Xanchor-Xpos||_2  counter: 
[ 2944 24486 42164 42423 33138 23051 14484  8593  4773  2573  1342   659
   330   144    69    20     8     4     2     2]
||Xanchor-Xneg||_2  counter: 
[ 1647 18823 38245 41979 35414 25435 16458 10352  6071  3322  1755   910
   439   197    98    39    12     7     3     3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.94515562   6.80699627  11.66883693  16.53067758  21.39251823
  26.25435889  31.11619954  35.97804019  40.83988085  45.7017215
  50.56356215  55.42540281  60.28724346  65.14908412  70.01092477
  74.87276542  79.73460608  84.59644673  89.45828738  94.32012804
  99.18196869]
distance difference  counter: 
(array([     2,      1,      0,      0,      2,     10,     10,     19,
           31,     53,    123,    251,    497,   1036,   2372,   6437,
        22743, 120452,  45319,   1851]), array([-6.24523783, -5.88853002, -5.53182222, -5.17511441, -4.81840661,
       -4.4616988 , -4.10499099, -3.74828319, -3.39157538, -3.03486758,
       -2.67815977, -2.32145197, -1.96474416, -1.60803636, -1.25132855,
       -0.89462075, -0.53791294, -0.18120514,  0.17550267,  0.53221048,
        0.88891828]))
||Xanchor-Xpos||_2  counter: 
[1946 4583 6618 7496 7116 5593 3954 2620 1556  841  504  243  145   70   31
   18   10    2    1    1]
||Xanchor-Xneg||_2  counter: 
[1141 3443 5369 6591 6891 6129 4633 3362 2289 1410  900  545  324  154   77
   49   19   16    6    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.07297754   2.80942457   4.54587159   6.28231862   8.01876564
   9.75521266  11.49165969  13.22810671  14.96455374  16.70100076
  18.43744779  20.17389481  21.91034184  23.64678886  25.38323588
  27.11968291  28.85612993  30.59257696  32.32902398  34.06547101
  35.80191803]
distance difference  counter: 
(array([    3,     0,     3,     6,     7,    14,     9,    29,    56,
          82,   165,   265,   481,   937,  2043,  4972, 14484, 15449,
        3997,   348]), array([-4.18465376, -3.9295201 , -3.67438644, -3.41925278, -3.16411912,
       -2.90898547, -2.65385181, -2.39871815, -2.14358449, -1.88845083,
       -1.63331717, -1.37818351, -1.12304986, -0.8679162 , -0.61278254,
       -0.35764888, -0.10251522,  0.15261844,  0.4077521 ,  0.66288576,
        0.91801941]))
train/val Accuracy = 0.526596722811 / 0.503517877739 
 with threshold: [[ 22.45608003]]
============ epoch 3 ===========
training loss:		1.639842
||Xanchor-Xpos||_2  counter: 
[ 4812 33956 51006 44490 30682 17926  9678  4789  2207   968   408   162
    80    23    12     6     3     0     1     0]
||Xanchor-Xneg||_2  counter: 
[ 2735 25573 46108 44559 33514 21702 12972  7057  3617  1711   927   411
   193    80    33    13     2     1     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.96057826   3.72082324   6.48106821   9.24131319  12.00155816
  14.76180314  17.52204811  20.28229308  23.04253806  25.80278303
  28.56302801  31.32327298  34.08351796  36.84376293  39.60400791
  42.36425288  45.12449785  47.88474283  50.6449878   53.40523278
  56.16547775]
distance difference  counter: 
(array([     1,      1,      1,      0,      2,      5,      4,      7,
           15,     39,     55,    128,    265,    622,   1366,   3184,
         9636,  61269, 118061,   6548]), array([-7.83940649, -7.40083042, -6.96225435, -6.52367828, -6.08510221,
       -5.64652614, -5.20795007, -4.769374  , -4.33079793, -3.89222187,
       -3.4536458 , -3.01506973, -2.57649366, -2.13791759, -1.69934152,
       -1.26076545, -0.82218938, -0.38361331,  0.05496276,  0.49353883,
        0.9321149 ]))
||Xanchor-Xpos||_2  counter: 
[ 3602  8133 10099  8441  5631  3274  1861   983   592   301   186   101
    68    38    23     8     4     3     2     0]
||Xanchor-Xneg||_2  counter: 
[2296 6099 8746 8534 6423 4376 2706 1639  990  616  382  224  162   68   39
   27   15    5    1    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.50228733   1.88732492   3.27236251   4.6574001    6.0424377
   7.42747529   8.81251288  10.19755047  11.58258806  12.96762566
  14.35266325  15.73770084  17.12273843  18.50777602  19.89281362
  21.27785121  22.6628888   24.04792639  25.43296399  26.81800158
  28.20303917]
distance difference  counter: 
(array([    2,     3,     5,     8,    10,    13,    27,    50,    62,
          80,   146,   242,   414,   841,  1692,  3861,  9621, 16878,
        8365,  1030]), array([-4.3365531 , -4.07242509, -3.80829707, -3.54416906, -3.28004105,
       -3.01591304, -2.75178503, -2.48765702, -2.22352901, -1.95940099,
       -1.69527298, -1.43114497, -1.16701696, -0.90288895, -0.63876094,
       -0.37463292, -0.11050491,  0.1536231 ,  0.41775111,  0.68187912,
        0.94600713]))
train/val Accuracy = 0.539526064937 / 0.515813148789 
 with threshold: [[ 11.17211401]]
============ epoch 4 ===========
training loss:		1.639451
||Xanchor-Xpos||_2  counter: 
[14123 62469 59994 34593 16310  7392  3407  1610   721   305   141    80
    41    12     6     3     1     1     0     0]
||Xanchor-Xneg||_2  counter: 
[ 7831 47998 56937 38758 22434 12323  6996  3749  2009  1049   565   285
   162    56    24    17     9     3     0     3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.61214662   2.96104807   5.30994952   7.65885097  10.00775242
  12.35665387  14.70555532  17.05445677  19.40335822  21.75225967
  24.10116112  26.45006257  28.79896402  31.14786547  33.49676692
  35.84566838  38.19456983  40.54347128  42.89237273  45.24127418
  47.59017563]
distance difference  counter: 
(array([     1,      0,      1,      2,      3,      7,      9,     18,
           29,     72,    106,    239,    403,    800,   1672,   3798,
        11574,  43377, 120182,  18916]), array([ -8.69689655e+00,  -8.21417002e+00,  -7.73144349e+00,
        -7.24871696e+00,  -6.76599042e+00,  -6.28326389e+00,
        -5.80053736e+00,  -5.31781083e+00,  -4.83508430e+00,
        -4.35235776e+00,  -3.86963123e+00,  -3.38690470e+00,
        -2.90417817e+00,  -2.42145163e+00,  -1.93872510e+00,
        -1.45599857e+00,  -9.73272038e-01,  -4.90545505e-01,
        -7.81897306e-03,   4.74907559e-01,   9.57634091e-01]))
||Xanchor-Xpos||_2  counter: 
[ 5709 12007 10625  6430  3724  2068  1223   647   392   221   126    82
    49    28    10     2     5     1     1     0]
||Xanchor-Xneg||_2  counter: 
[ 3423  9256 10109  7505  4938  3200  1865  1173   751   457   283   191
    95    42    35    17     5     2     1     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.35060075   1.7695745    3.18854826   4.60752201   6.02649577
   7.44546952   8.86444328  10.28341703  11.70239078  13.12136454
  14.54033829  15.95931205  17.3782858   18.79725956  20.21623331
  21.63520706  23.05418082  24.47315457  25.89212833  27.31110208
  28.73007584]
distance difference  counter: 
(array([    4,     4,     3,     3,     9,    13,    17,    48,    53,
          84,   131,   259,   430,   800,  1512,  3148,  6525, 13659,
       14021,  2627]), array([-5.03548241, -4.73594741, -4.43641241, -4.13687741, -3.83734242,
       -3.53780742, -3.23827242, -2.93873743, -2.63920243, -2.33966743,
       -2.04013243, -1.74059744, -1.44106244, -1.14152744, -0.84199244,
       -0.54245745, -0.24292245,  0.05661255,  0.35614755,  0.65568254,
        0.95521754]))
train/val Accuracy = 0.560069380594 / 0.538062283737 
 with threshold: [[ 7.38754912]]
============ epoch 5 ===========
training loss:		1.639378
||Xanchor-Xpos||_2  counter: 
[20047 73315 54494 27098 13241  6583  3268  1583   815   391   191    95
    46    18    11     8     2     2     1     0]
||Xanchor-Xneg||_2  counter: 
[10213 53640 54151 34648 20391 11992  7059  4012  2353  1297   703   372
   184    98    54    19    10     7     2     4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.48434877   2.67820117   4.87205358   7.06590598   9.25975838
  11.45361078  13.64746318  15.84131558  18.03516798  20.22902038
  22.42287278  24.61672518  26.81057758  29.00442998  31.19828238
  33.39213479  35.58598719  37.77983959  39.97369199  42.16754439
  44.36139679]
distance difference  counter: 
(array([     1,      1,      1,      3,      4,      5,     21,     25,
           54,     73,    160,    311,    504,    988,   2042,   5129,
        14288,  42996, 105615,  28988]), array([-9.02279091, -8.52341743, -8.02404394, -7.52467046, -7.02529697,
       -6.52592349, -6.02655001, -5.52717652, -5.02780304, -4.52842956,
       -4.02905607, -3.52968259, -3.0303091 , -2.53093562, -2.03156214,
       -1.53218865, -1.03281517, -0.53344169, -0.0340682 ,  0.46530528,
        0.96467876]))
||Xanchor-Xpos||_2  counter: 
[ 4281  9730 10015  7336  4667  2893  1749  1054   647   410   214   130
   102    52    35    17     7     6     2     2]
||Xanchor-Xneg||_2  counter: 
[2358 6619 8835 7810 5692 3945 2841 1876 1203  831  482  337  224  135   70
   46   24   15    2    5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.29102114   1.49808034   2.70513954   3.91219875   5.11925795
   6.32631715   7.53337636   8.74043556   9.94749476  11.15455397
  12.36161317  13.56867237  14.77573158  15.98279078  17.18984998
  18.39690918  19.60396839  20.81102759  22.01808679  23.225146    24.4322052 ]
distance difference  counter: 
(array([    3,     4,     3,     5,     9,    14,    33,    35,    69,
         118,   169,   292,   505,   964,  1843,  3624,  7173, 13532,
       12523,  2432]), array([-4.88841772, -4.59589139, -4.30336506, -4.01083874, -3.71831241,
       -3.42578608, -3.13325975, -2.84073342, -2.54820709, -2.25568076,
       -1.96315444, -1.67062811, -1.37810178, -1.08557545, -0.79304912,
       -0.50052279, -0.20799646,  0.08452986,  0.37705619,  0.66958252,
        0.96210885]))
train/val Accuracy = 0.577421984106 / 0.552848904268 
 with threshold: [[ 6.51942037]]
============ epoch 6 ===========
training loss:		1.639359
||Xanchor-Xpos||_2  counter: 
[24229 75015 52431 25507 12436  5938  2929  1408   713   335   139    61
    35    23     8     1     1     0     0     0]
||Xanchor-Xneg||_2  counter: 
[11869 53450 53360 35082 20579 11761  6825  3823  2108  1148   645   321
   123    56    32    15     6     3     0     3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.52747929   2.70357973   4.87968017   7.05578061   9.23188105
  11.40798149  13.58408192  15.76018236  17.9362828   20.11238324
  22.28848368  24.46458412  26.64068456  28.816785    30.99288543
  33.16898587  35.34508631  37.52118675  39.69728719  41.87338763
  44.04948807]
distance difference  counter: 
(array([    4,     3,     1,     7,    11,    11,    21,    41,    75,
         144,   248,   383,   705,  1462,  3079,  7383, 19174, 51739,
       95256, 21462]), array([-8.16602802, -7.70921561, -7.25240321, -6.7955908 , -6.33877839,
       -5.88196598, -5.42515357, -4.96834116, -4.51152875, -4.05471635,
       -3.59790394, -3.14109153, -2.68427912, -2.22746671, -1.7706543 ,
       -1.31384189, -0.85702949, -0.40021708,  0.05659533,  0.51340774,
        0.97022015]))
||Xanchor-Xpos||_2  counter: 
[ 4750 10813 10435  7142  4442  2520  1429   793   467   246   138    85
    43    26    11     4     4     2     0     0]
||Xanchor-Xneg||_2  counter: 
[2529 7227 9658 7921 5550 3874 2521 1599 1042  625  347  225  118   56   30
   17    5    5    0    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.27190408   1.59385623   2.91580838   4.23776052   5.55971267
   6.88166482   8.20361697   9.52556912  10.84752126  12.16947341
  13.49142556  14.81337771  16.13532985  17.457282    18.77923415
  20.1011863   21.42313845  22.74509059  24.06704274  25.38899489
  26.71094704]
distance difference  counter: 
(array([    3,     2,     5,     7,    15,    24,    41,    52,    83,
         131,   192,   358,   627,  1178,  2200,  4106,  7918, 13525,
       10852,  2031]), array([-4.59172249, -4.31421408, -4.03670567, -3.75919726, -3.48168885,
       -3.20418043, -2.92667202, -2.64916361, -2.3716552 , -2.09414679,
       -1.81663838, -1.53912997, -1.26162156, -0.98411315, -0.70660474,
       -0.42909633, -0.15158792,  0.1259205 ,  0.40342891,  0.68093732,
        0.95844573]))
train/val Accuracy = 0.586912116257 / 0.56014994233 
 with threshold: [[ 6.34734127]]
============ epoch 7 ===========
training loss:		1.639354
||Xanchor-Xpos||_2  counter: 
[25481 78888 52548 24395 10870  4982  2305   971   428   197    90    39
    11     1     1     2     0     0     0     0]
||Xanchor-Xneg||_2  counter: 
[12044 56122 55464 35334 19855 10839  5650  3070  1444   743   357   170
    72    29    10     3     2     0     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.44632763   2.72489072   5.00345382   7.28201692   9.56058002
  11.83914311  14.11770621  16.39626931  18.6748324   20.9533955
  23.2319586   25.5105217   27.78908479  30.06764789  32.34621099
  34.62477408  36.90333718  39.18190028  41.46046337  43.73902647
  46.01758957]
distance difference  counter: 
(array([     1,      0,      1,      2,      2,      6,     13,     21,
           25,     73,    144,    245,    489,    956,   2170,   5421,
        15502,  45553, 101210,  29375]), array([-8.9481678 , -8.45289662, -7.95762544, -7.46235425, -6.96708307,
       -6.47181189, -5.97654071, -5.48126953, -4.98599834, -4.49072716,
       -3.99545598, -3.5001848 , -3.00491362, -2.50964243, -2.01437125,
       -1.51910007, -1.02382889, -0.52855771, -0.03328652,  0.46198466,
        0.95725584]))
||Xanchor-Xpos||_2  counter: 
[3705 8863 9787 7568 5243 3307 1971 1156  736  435  234  149   88   52   27
    9   12    5    2    1]
||Xanchor-Xneg||_2  counter: 
[1929 5465 8187 7925 6178 4440 3097 2100 1473  976  617  417  232  150   67
   48   31    8    5    5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.290898     1.45064537   2.61039275   3.77014013   4.92988751
   6.08963489   7.24938227   8.40912964   9.56887702  10.7286244
  11.88837178  13.04811916  14.20786654  15.36761392  16.52736129
  17.68710867  18.84685605  20.00660343  21.16635081  22.32609819
  23.48584557]
distance difference  counter: 
(array([    2,     3,     1,     5,     8,    25,    34,    49,    72,
         136,   172,   370,   596,  1129,  2153,  3990,  7856, 13547,
       11020,  2182]), array([-4.61872768, -4.34044307, -4.06215845, -3.78387384, -3.50558922,
       -3.22730461, -2.94901999, -2.67073538, -2.39245076, -2.11416615,
       -1.83588153, -1.55759692, -1.2793123 , -1.00102769, -0.72274307,
       -0.44445845, -0.16617384,  0.11211078,  0.39039539,  0.66868001,
        0.94696462]))
train/val Accuracy = 0.590855776829 / 0.561337946943 
 with threshold: [[ 6.26465089]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812, 0.57609686188627585]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.03, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 0.01
============ epoch 0 ===========
training loss:		0.017738
||Xanchor-Xpos||_2  counter: 
[  524  8753 24167 34289 35842 32035 25094 17311 10901  6156  3341  1583
   712   299   113    54    16    11     6     2]
||Xanchor-Xneg||_2  counter: 
[  272  5660 19196 31446 35947 33322 26987 19861 12934  7761  4190  2025
   899   417   185    59    24    15     4     5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  15.14105415   41.46993589   67.79881763   94.12769938  120.45658112
  146.78546286  173.1143446   199.44322634  225.77210808  252.10098982
  278.42987156  304.7587533   331.08763504  357.41651678  383.74539852
  410.07428026  436.403162    462.73204374  489.06092548  515.38980722
  541.71868896]
distance difference  counter: 
(array([    1,     1,     0,     2,     0,     3,     8,    15,    11,
          39,    62,   129,   266,   565,  1443,  3780, 13097, 78195,
       99930,  3662]), array([-8.02113247, -7.57702362, -7.13291478, -6.68880593, -6.24469708,
       -5.80058824, -5.35647939, -4.91237054, -4.46826169, -4.02415285,
       -3.580044  , -3.13593515, -2.69182631, -2.24771746, -1.80360861,
       -1.35949977, -0.91539092, -0.47128207, -0.02717323,  0.41693562,
        0.86104447]))
||Xanchor-Xpos||_2  counter: 
[1418 3488 5021 6254 6538 5859 4875 3655 2548 1590  975  557  310  161   50
   33   13    3    1    1]
||Xanchor-Xneg||_2  counter: 
[ 793 2460 4021 5419 5973 5977 5286 4185 3240 2326 1437  974  572  354  191
   81   35   17    8    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  11.57221413   26.27176046   40.9713068    55.67085314   70.37039948
   85.06994581   99.76949215  114.46903849  129.16858482  143.86813116
  158.5676775   173.26722383  187.96677017  202.66631651  217.36586285
  232.06540918  246.76495552  261.46450186  276.16404819  290.86359453
  305.56314087]
distance difference  counter: 
(array([    1,     0,     0,     1,     2,     1,     1,     8,    11,
          17,    33,    61,   116,   252,   564,  1280,  3785, 15564,
       20304,  1349]), array([-8.47605133, -8.00789054, -7.53972976, -7.07156897, -6.60340818,
       -6.13524739, -5.66708661, -5.19892582, -4.73076503, -4.26260425,
       -3.79444346, -3.32628267, -2.85812188, -2.3899611 , -1.92180031,
       -1.45363952, -0.98547873, -0.51731795, -0.04915716,  0.41900363,
        0.88716441]))
train/val Accuracy = 0.526711031813 / 0.51967704729 
 with threshold: [[ 156.0158961]]
============ epoch 1 ===========
training loss:		0.017543
||Xanchor-Xpos||_2  counter: 
[  848 10392 25210 34581 35055 31318 24398 16657 10641  6113  3225  1538
   685   324   132    59    22     4     4     2]
||Xanchor-Xneg||_2  counter: 
[  429  6898 20373 31743 35207 32816 26481 19028 12753  7602  4047  2145
   932   454   178    83    22     8     5     4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  17.13705826   41.24397182   65.35088539   89.45779896  113.56471252
  137.67162609  161.77853966  185.88545322  209.99236679  234.09928036
  258.20619392  282.31310749  306.42002106  330.52693462  354.63384819
  378.74076176  402.84767532  426.95458889  451.06150246  475.16841602
  499.27532959]
distance difference  counter: 
(array([     1,      0,      0,      0,      1,      0,      2,      4,
            7,     17,     30,     64,    129,    362,    865,   2221,
         7796,  44209, 138723,   6778]), array([-9.35386276, -8.84294754, -8.33203231, -7.82111709, -7.31020186,
       -6.79928663, -6.28837141, -5.77745618, -5.26654096, -4.75562573,
       -4.24471051, -3.73379528, -3.22288005, -2.71196483, -2.2010496 ,
       -1.69013438, -1.17921915, -0.66830392, -0.1573887 ,  0.35352653,
        0.86444175]))
||Xanchor-Xpos||_2  counter: 
[1425 3687 5478 6652 6793 5989 4678 3433 2281 1316  777  422  257   89   48
   19    4    1    1    0]
||Xanchor-Xneg||_2  counter: 
[ 786 2652 4376 5732 6373 6127 5286 4072 3036 1950 1270  748  470  263  118
   59   17   12    1    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   9.88626862   24.27764854   38.66902847   53.0604084    67.45178833
   81.84316826   96.23454819  110.62592812  125.01730804  139.40868797
  153.8000679   168.19144783  182.58282776  196.97420769  211.36558762
  225.75696754  240.14834747  254.5397274   268.93110733  283.32248726
  297.71386719]
distance difference  counter: 
(array([    1,     0,     0,     0,     0,     2,     1,     3,     4,
           7,    17,    38,    62,   139,   317,   841,  2480, 10201,
       27062,  2175]), array([-9.93099117, -9.38991664, -8.8488421 , -8.30776757, -7.76669303,
       -7.2256185 , -6.68454396, -6.14346943, -5.60239489, -5.06132036,
       -4.52024582, -3.97917129, -3.43809675, -2.89702221, -2.35594768,
       -1.81487314, -1.27379861, -0.73272407, -0.19164954,  0.349425  ,
        0.89049953]))
train/val Accuracy = 0.527342216302 / 0.520196078431 
 with threshold: [[ 144.5350693]]
============ epoch 2 ===========
training loss:		0.017377
||Xanchor-Xpos||_2  counter: 
[  665  8963 22766 32329 34387 31083 25283 18411 12085  7196  4127  2044
  1005   493   212   106    36    13     4     1]
||Xanchor-Xneg||_2  counter: 
[  333  5728 18076 28967 34036 32301 27186 20560 14253  9060  5295  2860
  1368   673   302   129    44    20    11     7]
||Xanchor-X_neg/pos||_2  bins edge: 
[  15.27253056   36.7901113    58.30769205   79.8252728   101.34285355
  122.86043429  144.37801504  165.89559579  187.41317654  208.93075728
  230.44833803  251.96591878  273.48349953  295.00108027  316.51866102
  338.03624177  359.55382252  381.07140326  402.58898401  424.10656476
  445.62414551]
distance difference  counter: 
(array([     1,      0,      0,      1,      2,      2,      5,      4,
           13,     24,     36,    109,    205,    451,   1077,   2905,
         9820,  60746, 121649,   4159]), array([-8.98479557, -8.49037907, -7.99596257, -7.50154606, -7.00712956,
       -6.51271306, -6.01829656, -5.52388006, -5.02946355, -4.53504705,
       -4.04063055, -3.54621405, -3.05179754, -2.55738104, -2.06296454,
       -1.56854804, -1.07413154, -0.57971503, -0.08529853,  0.40911797,
        0.90353447]))
||Xanchor-Xpos||_2  counter: 
[1488 3761 5630 6854 6762 5952 4703 3310 2085 1280  771  386  215   91   38
   14    7    1    2    0]
||Xanchor-Xneg||_2  counter: 
[ 814 2714 4485 5846 6491 6183 5202 3983 2905 1915 1224  742  416  240  110
   45   21   11    1    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   9.12014198   22.68762426   36.25510654   49.82258883   63.39007111
   76.95755339   90.52503567  104.09251795  117.66000023  131.22748251
  144.79496479  158.36244707  171.92992935  185.49741163  199.06489391
  212.63237619  226.19985847  239.76734076  253.33482304  266.90230532
  280.4697876 ]
distance difference  counter: 
(array([    1,     0,     0,     0,     3,     1,     1,     3,     9,
          10,    22,    44,   103,   143,   389,  1010,  2874, 11516,
       25260,  1961]), array([-9.38414669, -8.87072748, -8.35730827, -7.84388907, -7.33046986,
       -6.81705065, -6.30363144, -5.79021223, -5.27679303, -4.76337382,
       -4.24995461, -3.7365354 , -3.2231162 , -2.70969699, -2.19627778,
       -1.68285857, -1.16943936, -0.65602016, -0.14260095,  0.37081826,
        0.88423747]))
train/val Accuracy = 0.528467911475 / 0.520369088812 
 with threshold: [[ 134.06513899]]
============ epoch 3 ===========
training loss:		0.017236
||Xanchor-Xpos||_2  counter: 
[  872 12555 29791 38903 37553 31036 21994 13913  7678  3902  1771   731
   306   124    45    28     2     2     1     2]
||Xanchor-Xneg||_2  counter: 
[  449  8362 24633 36536 37999 32570 24698 16487  9779  5182  2517  1175
   517   178    67    39    14     1     5     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  12.81829929   35.58307281   58.34784632   81.11261983  103.87739334
  126.64216685  149.40694036  172.17171388  194.93648739  217.7012609
  240.46603441  263.23080792  285.99558144  308.76035495  331.52512846
  354.28990197  377.05467548  399.819449    422.58422251  445.34899602
  468.11376953]
distance difference  counter: 
(array([    2,     1,     0,     2,     2,     4,     6,    13,    24,
          37,    97,   176,   347,   755,  1642,  4227, 14448, 93987,
       82783,  2656]), array([-8.04454517, -7.5970183 , -7.14949144, -6.70196457, -6.2544377 ,
       -5.80691083, -5.35938396, -4.91185709, -4.46433022, -4.01680335,
       -3.56927648, -3.12174961, -2.67422274, -2.22669587, -1.77916901,
       -1.33164214, -0.88411527, -0.4365884 ,  0.01093847,  0.45846534,
        0.90599221]))
||Xanchor-Xpos||_2  counter: 
[1809 3980 5998 7212 6722 5911 4490 3009 1905 1068  643  307  176   72   30
   13    2    2    1    0]
||Xanchor-Xneg||_2  counter: 
[1043 2926 4856 6136 6692 6213 5012 3754 2645 1673 1064  637  367  189   81
   35   15    8    1    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   9.18344021   22.1635077    35.14357519   48.12364268   61.10371017
   74.08377767   87.06384516  100.04391265  113.02398014  126.00404763
  138.98411512  151.96418262  164.94425011  177.9243176   190.90438509
  203.88445258  216.86452007  229.84458756  242.82465506  255.80472255
  268.78479004]
distance difference  counter: 
(array([    1,     0,     0,     1,     2,     1,     1,     3,     6,
          12,    22,    41,    85,   162,   387,   904,  2738, 11042,
       25870,  2072]), array([-9.569911  , -9.04699857, -8.52408614, -8.00117371, -7.47826128,
       -6.95534885, -6.43243642, -5.90952399, -5.38661156, -4.86369913,
       -4.3407867 , -3.81787426, -3.29496183, -2.7720494 , -2.24913697,
       -1.72622454, -1.20331211, -0.68039968, -0.15748725,  0.36542518,
        0.88833761]))
train/val Accuracy = 0.529668155997 / 0.520818915802 
 with threshold: [[ 124.40464744]]
============ epoch 4 ===========
training loss:		0.017117
||Xanchor-Xpos||_2  counter: 
[ 1093 14168 31966 39446 37695 30103 21053 12774  6954  3419  1509   620
   244   100    41    16     6     1     1     0]
||Xanchor-Xneg||_2  counter: 
[  607  9534 26520 37303 38136 32201 23729 15611  8998  4667  2248   999
   392   153    62    30     9     8     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  12.76262379   34.26939921   55.77617464   77.28295007   98.78972549
  120.29650092  141.80327635  163.31005177  184.8168272   206.32360263
  227.83037806  249.33715348  270.84392891  292.35070434  313.85747976
  335.36425519  356.87103062  378.37780604  399.88458147  421.3913569
  442.89813232]
distance difference  counter: 
(array([     3,      0,      4,      5,      3,      3,     16,     23,
           32,     62,    123,    231,    446,    881,   2018,   4937,
        16488, 105610,  67846,   2478]), array([-7.66426086, -7.23610901, -6.80795716, -6.37980531, -5.95165346,
       -5.5235016 , -5.09534975, -4.6671979 , -4.23904605, -3.8108942 ,
       -3.38274235, -2.95459049, -2.52643864, -2.09828679, -1.67013494,
       -1.24198309, -0.81383123, -0.38567938,  0.04247247,  0.47062432,
        0.89877617]))
||Xanchor-Xpos||_2  counter: 
[1646 3879 5868 6939 6754 5925 4532 3213 2038 1181  660  338  213   97   36
   20    7    2    1    1]
||Xanchor-Xneg||_2  counter: 
[ 945 2843 4648 5898 6548 6168 5098 3909 2787 1750 1184  703  424  230  117
   60   21   12    3    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   8.2657938    20.13525558   32.00471735   43.87417912   55.7436409
   67.61310267   79.48256445   91.35202622  103.221488    115.09094977
  126.96041155  138.82987332  150.6993351   162.56879687  174.43825865
  186.30772042  198.1771822   210.04664397  221.91610575  233.78556752
  245.6550293 ]
distance difference  counter: 
(array([    1,     0,     0,     0,     1,     0,     2,     2,     3,
          10,    16,    29,    69,   131,   317,   735,  2174,  9080,
       28190,  2590]), array([-10.38962173,  -9.82517958,  -9.26073743,  -8.69629528,
        -8.13185313,  -7.56741098,  -7.00296882,  -6.43852667,
        -5.87408452,  -5.30964237,  -4.74520022,  -4.18075806,
        -3.61631591,  -3.05187376,  -2.48743161,  -1.92298946,
        -1.35854731,  -0.79410515,  -0.229663  ,   0.33477915,   0.8992213 ]))
train/val Accuracy = 0.531196417655 / 0.52216839677 
 with threshold: [[ 115.56049571]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812, 0.57609686188627585, 0.5266824072128734]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.03, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 0.1
============ epoch 0 ===========
training loss:		0.170971
||Xanchor-Xpos||_2  counter: 
[ 4057 26290 42235 41779 32491 21980 14043  8479  4768  2563  1338   678
   272   134    65    23     8     6     0     0]
||Xanchor-Xneg||_2  counter: 
[ 2503 21038 39002 42070 34512 24525 15762  9807  5602  3205  1691   814
   379   163    86    30    14     4     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  11.86606121   35.77721372   59.68836622   83.59951873  107.51067123
  131.42182374  155.33297625  179.24412875  203.15528126  227.06643376
  250.97758627  274.88873878  298.79989128  322.71104379  346.62219629
  370.5333488   394.4445013   418.35565381  442.26680632  466.17795882
  490.08911133]
distance difference  counter: 
(array([     1,      1,      0,      1,      2,      3,      6,     12,
           21,     38,     78,    141,    318,    695,   1730,   4558,
        16545, 101329,  73570,   2160]), array([-7.63388395, -7.20745789, -6.78103182, -6.35460575, -5.92817968,
       -5.50175361, -5.07532755, -4.64890148, -4.22247541, -3.79604934,
       -3.36962327, -2.94319721, -2.51677114, -2.09034507, -1.663919  ,
       -1.23749293, -0.81106687, -0.3846408 ,  0.04178527,  0.46821134,
        0.89463741]))
||Xanchor-Xpos||_2  counter: 
[1054 3290 4567 5893 6344 5854 5179 3846 2708 1816 1192  737  422  218  136
   57   21   10    4    1]
||Xanchor-Xneg||_2  counter: 
[ 542 2326 3598 4878 5636 6026 5426 4466 3420 2568 1620 1151  736  465  244
  127   70   29   16    6]
||Xanchor-X_neg/pos||_2  bins edge: 
[   5.21164465   11.98154948   18.75145431   25.52135913   32.29126396
   39.06116879   45.83107362   52.60097845   59.37088327   66.1407881
   72.91069293   79.68059776   86.45050259   93.22040741   99.99031224
  106.76021707  113.5301219   120.30002673  127.06993155  133.83983638
  140.60974121]
distance difference  counter: 
(array([    1,     1,     1,     2,     2,     5,     9,     9,    14,
          36,    61,   113,   203,   404,   905,  2180,  6368, 22410,
        9859,   767]), array([-6.78937054, -6.40567992, -6.0219893 , -5.63829868, -5.25460806,
       -4.87091744, -4.48722682, -4.1035362 , -3.71984558, -3.33615496,
       -2.95246434, -2.56877372, -2.1850831 , -1.80139248, -1.41770186,
       -1.03401124, -0.65032063, -0.26663001,  0.11706061,  0.50075123,
        0.88444185]))
train/val Accuracy = 0.523788697325 / 0.501188004614 
 with threshold: [[ 110.90445645]]
============ epoch 1 ===========
training loss:		0.165350
||Xanchor-Xpos||_2  counter: 
[ 2096 21021 39339 42382 34512 24438 16086  9642  5478  3042  1598   871
   378   184    80    38    13     9     2     0]
||Xanchor-Xneg||_2  counter: 
[ 1161 15512 35055 41330 36229 27118 18280 11595  6850  3871  2164  1049
   555   252   111    42    18    10     4     3]
||Xanchor-X_neg/pos||_2  bins edge: 
[   3.74006224   14.33067906   24.92129588   35.5119127    46.10252953
   56.69314635   67.28376317   77.87437999   88.46499681   99.05561364
  109.64623046  120.23684728  130.8274641   141.41808093  152.00869775
  162.59931457  173.18993139  183.78054821  194.37116504  204.96178186
  215.55239868]
distance difference  counter: 
(array([     1,      0,      1,      2,      1,      1,      6,     11,
            9,     25,     63,    123,    244,    517,   1199,   3238,
        10728,  67928, 113081,   4031]), array([-8.41264629, -7.94718543, -7.48172457, -7.0162637 , -6.55080284,
       -6.08534198, -5.61988111, -5.15442025, -4.68895938, -4.22349852,
       -3.75803766, -3.29257679, -2.82711593, -2.36165507, -1.8961942 ,
       -1.43073334, -0.96527247, -0.49981161, -0.03435075,  0.43111012,
        0.89657098]))
||Xanchor-Xpos||_2  counter: 
[1463 3987 5838 7070 6879 6030 4447 2977 1952 1159  722  390  224   95   64
   27   15    5    4    1]
||Xanchor-Xneg||_2  counter: 
[ 772 2871 4602 6002 6575 6336 5185 3899 2647 1618 1190  709  455  221  140
   64   32   21    7    4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  2.31843567   5.96072273   9.6030098   13.24529686  16.88758392
  20.52987099  24.17215805  27.81444511  31.45673218  35.09901924
  38.7413063   42.38359337  46.02588043  49.6681675   53.31045456
  56.95274162  60.59502869  64.23731575  67.87960281  71.52188988
  75.16417694]
distance difference  counter: 
(array([    2,     1,     1,     0,     2,     6,    11,    13,    24,
          53,    62,   131,   217,   466,   906,  2293,  6843, 22644,
        8957,   718]), array([-6.46739531, -6.09795231, -5.72850932, -5.35906633, -4.98962333,
       -4.62018034, -4.25073735, -3.88129435, -3.51185136, -3.14240837,
       -2.77296537, -2.40352238, -2.03407938, -1.66463639, -1.2951934 ,
       -0.9257504 , -0.55630741, -0.18686442,  0.18257858,  0.55202157,
        0.92146456]))
train/val Accuracy = 0.52800570551 / 0.502895040369 
 with threshold: [[ 50.40409258]]
============ epoch 2 ===========
training loss:		0.164258
||Xanchor-Xpos||_2  counter: 
[ 4081 35222 53957 45553 29775 16904  8598  4118  1785   762   267   102
    54    20     8     1     2     0     0     0]
||Xanchor-Xneg||_2  counter: 
[ 2256 26253 49336 46864 33504 20585 11342  5907  2785  1349   575   272
   114    43    17     4     1     0     1     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   1.66601813    7.94490709   14.22379605   20.502685     26.78157396
   33.06046292   39.33935188   45.61824084   51.8971298    58.17601876
   64.45490772   70.73379667   77.01268563   83.29157459   89.57046355
   95.84935251  102.12824147  108.40713043  114.68601938  120.96490834
  127.2437973 ]
distance difference  counter: 
(array([     3,      1,      1,      0,      2,      2,      6,     12,
           25,     33,     70,    156,    352,    614,   1501,   3434,
        10121,  66770, 112725,   5381]), array([-8.21204948, -7.75656315, -7.30107682, -6.84559048, -6.39010415,
       -5.93461782, -5.47913148, -5.02364515, -4.56815882, -4.11267248,
       -3.65718615, -3.20169982, -2.74621348, -2.29072715, -1.83524082,
       -1.37975448, -0.92426815, -0.46878182, -0.01329548,  0.44219085,
        0.89767718]))
||Xanchor-Xpos||_2  counter: 
[1460 4187 6527 7932 7390 5785 3911 2584 1534  891  537  298  153   81   41
   16   11    7    2    3]
||Xanchor-Xneg||_2  counter: 
[ 779 2634 4859 6646 7161 6363 4935 3648 2318 1552 1027  620  338  216  113
   75   36   16    8    6]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.1791594    3.19358114   5.20800288   7.22242461   9.23684635
  11.25126809  13.26568983  15.28011156  17.2945333   19.30895504
  21.32337677  23.33779851  25.35222025  27.36664199  29.38106372
  31.39548546  33.4099072   35.42432894  37.43875067  39.45317241
  41.46759415]
distance difference  counter: 
(array([    1,     0,     0,     2,     0,     3,     9,    11,    19,
          43,    61,   111,   230,   456,   990,  2506,  7594, 20836,
        9728,   750]), array([-5.95923185, -5.61483941, -5.27044697, -4.92605453, -4.58166209,
       -4.23726965, -3.89287722, -3.54848478, -3.20409234, -2.8596999 ,
       -2.51530746, -2.17091502, -1.82652258, -1.48213014, -1.1377377 ,
       -0.79334526, -0.44895282, -0.10456038,  0.23983206,  0.5842245 ,
        0.92861694]))
train/val Accuracy = 0.537652391295 / 0.507554786621 
 with threshold: [[ 24.22281588]]
============ epoch 3 ===========
training loss:		0.164060
||Xanchor-Xpos||_2  counter: 
[ 2794 25716 48654 48598 35220 20333 10719  5172  2245  1003   467   153
    82    25    14     7     4     1     2     0]
||Xanchor-Xneg||_2  counter: 
[ 1253 15130 37994 46639 38950 26640 16274  9066  4617  2425  1132   552
   292   136    55    21    17     9     6     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.59576392   4.72409569   7.85242746  10.98075923  14.109091
  17.23742276  20.36575453  23.4940863   26.62241807  29.75074984
  32.87908161  36.00741338  39.13574514  42.26407691  45.39240868
  48.52074045  51.64907222  54.77740399  57.90573575  61.03406752
  64.16239929]
distance difference  counter: 
(array([    2,     1,     0,     1,     4,     4,     6,    13,    25,
          31,    96,   200,   338,   834,  1789,  4521, 16094, 88052,
       85480,  3718]), array([-7.48501301, -7.06473124, -6.64444947, -6.2241677 , -5.80388594,
       -5.38360417, -4.9633224 , -4.54304063, -4.12275887, -3.7024771 ,
       -3.28219533, -2.86191356, -2.44163179, -2.02135003, -1.60106826,
       -1.18078649, -0.76050472, -0.34022295,  0.08005881,  0.50034058,
        0.92062235]))
||Xanchor-Xpos||_2  counter: 
[1403 4266 6936 8283 7563 5707 3866 2342 1416  723  417  204  116   54   21
   20    6    3    3    1]
||Xanchor-Xneg||_2  counter: 
[ 692 2226 4373 6675 7222 6533 5069 3657 2530 1724 1095  688  388  221  147
   59   28   15    6    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.95130855   2.51431918   4.07732981   5.64034044   7.20335107
   8.7663617   10.32937233  11.89238296  13.45539359  15.01840422
  16.58141485  18.14442548  19.70743611  21.27044674  22.83345737
  24.396468    25.95947863  27.52248926  29.08549989  30.64851052
  32.21152115]
distance difference  counter: 
(array([    2,     1,     0,     5,     4,     5,    25,    35,    48,
          85,   155,   289,   603,  1143,  2296,  5261, 11247, 16151,
        5473,   522]), array([-4.64974022, -4.37145396, -4.09316769, -3.81488143, -3.53659517,
       -3.2583089 , -2.98002264, -2.70173638, -2.42345011, -2.14516385,
       -1.86687759, -1.58859132, -1.31030506, -1.0320188 , -0.75373253,
       -0.47544627, -0.19716001,  0.08112626,  0.35941252,  0.63769878,
        0.91598505]))
train/val Accuracy = 0.561560367578 / 0.539780853518 
 with threshold: [[ 14.08075549]]
============ epoch 4 ===========
training loss:		0.164025
||Xanchor-Xpos||_2  counter: 
[ 1279 16518 40370 48486 39981 26539 14634  7276  3466  1488   642   288
   126    61    32    11     6     4     1     1]
||Xanchor-Xneg||_2  counter: 
[  561  7794 25322 38610 40537 32828 23101 14414  8473  4634  2401  1284
   641   324   140    75    41    20     5     4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.22823226   3.55642827   5.88462428   8.21282029  10.54101629
  12.8692123   15.19740831  17.52560431  19.85380032  22.18199633
  24.51019233  26.83838834  29.16658435  31.49478036  33.82297636
  36.15117237  38.47936838  40.80756438  43.13576039  45.4639564
  47.7921524 ]
distance difference  counter: 
(array([    1,     0,     0,     1,     3,     3,     3,    11,    18,
          42,    78,   181,   388,   836,  1979,  5655, 21411, 81969,
       83992,  4638]), array([-7.3631959 , -6.94984692, -6.53649795, -6.12314898, -5.7098    ,
       -5.29645103, -4.88310206, -4.46975309, -4.05640411, -3.64305514,
       -3.22970617, -2.8163572 , -2.40300822, -1.98965925, -1.57631028,
       -1.1629613 , -0.74961233, -0.33626336,  0.07708561,  0.49043459,
        0.90378356]))
||Xanchor-Xpos||_2  counter: 
[1055 4218 6963 8238 7588 5952 3928 2410 1379  782  407  219  106   57   26
   12    5    4    0    1]
||Xanchor-Xneg||_2  counter: 
[ 491 2035 3980 6272 7339 6639 5323 3736 2722 1772 1272  754  468  267  155
   84   24   12    4    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.77245504   2.32054264   3.86863025   5.41671785   6.96480546
   8.51289307  10.06098067  11.60906828  13.15715588  14.70524349
  16.25333109  17.8014187   19.34950631  20.89759391  22.44568152
  23.99376912  25.54185673  27.08994434  28.63803194  30.18611955
  31.73420715]
distance difference  counter: 
(array([    1,     3,     3,     5,     6,    10,    23,    42,    69,
         122,   194,   425,   777,  1389,  2797,  5761, 11027, 14987,
        5209,   500]), array([-4.56351185, -4.28942354, -4.01533523, -3.74124691, -3.4671586 ,
       -3.19307029, -2.91898198, -2.64489367, -2.37080536, -2.09671705,
       -1.82262874, -1.54854043, -1.27445211, -1.0003638 , -0.72627549,
       -0.45218718, -0.17809887,  0.09598944,  0.37007775,  0.64416606,
        0.91825438]))
train/val Accuracy = 0.587361897331 / 0.566689734717 
 with threshold: [[ 11.7652878]]
============ epoch 5 ===========
training loss:		0.164017
||Xanchor-Xpos||_2  counter: 
[ 3132 29688 55360 51740 32733 16474  7309  2985  1126   397   158    65
    29     9     3     1     0     0     0     0]
||Xanchor-Xneg||_2  counter: 
[ 1210 14690 37579 47501 40707 27219 16223  8440  4178  1982   842   378
   145    69    28     7     8     1     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.33693945   3.98891248   6.64088551   9.29285854  11.94483156
  14.59680459  17.24877762  19.90075064  22.55272367  25.2046967
  27.85666972  30.50864275  33.16061578  35.8125888   38.46456183
  41.11653486  43.76850789  46.42048091  49.07245394  51.72442697
  54.37639999]
distance difference  counter: 
(array([    1,     0,     1,     2,     5,     4,    11,    20,    56,
          74,   165,   356,   643,  1462,  3524, 10330, 34553, 87840,
       58863,  3299]), array([-6.4659915 , -6.09798057, -5.72996965, -5.36195873, -4.9939478 ,
       -4.62593688, -4.25792596, -3.88991503, -3.52190411, -3.15389319,
       -2.78588226, -2.41787134, -2.04986042, -1.68184949, -1.31383857,
       -0.94582765, -0.57781672, -0.2098058 ,  0.15820512,  0.52621605,
        0.89422697]))
||Xanchor-Xpos||_2  counter: 
[1050 3804 6208 7497 7387 6046 4416 2886 1788 1057  583  290  162  106   32
   22    9    5    1    1]
||Xanchor-Xneg||_2  counter: 
[ 451 1851 3294 5207 6712 6528 5597 4269 3203 2185 1486 1095  622  378  225
  139   68   28    6    6]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.88972902   2.33122451   3.77272      5.21421549   6.65571098
   8.09720647   9.53870196  10.98019745  12.42169294  13.86318843
  15.30468392  16.74617941  18.1876749   19.62917039  21.07066588
  22.51216137  23.95365686  25.39515235  26.83664784  28.27814333
  29.71963882]
distance difference  counter: 
(array([    3,     1,     2,     3,     4,    17,    33,    49,    68,
         127,   252,   475,   855,  1582,  3064,  6055, 11445, 14257,
        4638,   420]), array([-4.48803186, -4.21735462, -3.94667737, -3.67600012, -3.40532287,
       -3.13464563, -2.86396838, -2.59329113, -2.32261388, -2.05193664,
       -1.78125939, -1.51058214, -1.23990489, -0.96922764, -0.6985504 ,
       -0.42787315, -0.1571959 ,  0.11348135,  0.38415859,  0.65483584,
        0.92551309]))
train/val Accuracy = 0.597267020859 / 0.573483275663 
 with threshold: [[ 11.44139188]]
============ epoch 6 ===========
training loss:		0.164014
||Xanchor-Xpos||_2  counter: 
[ 1288 18907 46605 52088 39059 22798 11578  5132  2286   843   367   149
    67    24     8     6     1     2     1     0]
||Xanchor-Xneg||_2  counter: 
[  504  8429 27731 42016 41832 32621 21533 12654  7102  3566  1763   776
   388   167    78    25    13     5     5     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.96450227   3.39817585   5.83184943   8.265523    10.69919658
  13.13287015  15.56654373  18.0002173   20.43389088  22.86756445
  25.30123803  27.73491161  30.16858518  32.60225876  35.03593233
  37.46960591  39.90327948  42.33695306  44.77062663  47.20430021
  49.63797379]
distance difference  counter: 
(array([    1,     0,     0,     1,     1,     0,     2,     4,    12,
          19,    48,    93,   264,   587,  1566,  4763, 18743, 72059,
       96565,  6481]), array([-8.16660786, -7.71234964, -7.25809141, -6.80383319, -6.34957497,
       -5.89531675, -5.44105853, -4.98680031, -4.53254209, -4.07828386,
       -3.62402564, -3.16976742, -2.7155092 , -2.26125098, -1.80699276,
       -1.35273454, -0.89847631, -0.44421809,  0.01004013,  0.46429835,
        0.91855657]))
||Xanchor-Xpos||_2  counter: 
[1173 4297 7003 8170 7656 5837 3926 2425 1399  751  369  178   89   43   21
    8    4    0    0    1]
||Xanchor-Xneg||_2  counter: 
[ 504 2055 3898 6064 7293 6714 5401 3964 2814 1799 1190  766  392  225  163
   69   26    7    4    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.85016936   2.39895757   3.94774577   5.49653398   7.04532218
   8.59411038  10.14289859  11.69168679  13.240475    14.7892632
  16.33805141  17.88683961  19.43562782  20.98441602  22.53320423
  24.08199243  25.63078064  27.17956884  28.72835705  30.27714525
  31.82593346]
distance difference  counter: 
(array([    1,     0,     3,     4,     6,    11,    20,    50,    82,
         143,   227,   451,   827,  1580,  2989,  5968, 11316, 14329,
        4869,   474]), array([-4.48825645, -4.21802285, -3.94778925, -3.67755564, -3.40732204,
       -3.13708843, -2.86685483, -2.59662122, -2.32638762, -2.05615402,
       -1.78592041, -1.51568681, -1.2454532 , -0.9752196 , -0.70498599,
       -0.43475239, -0.16451879,  0.10571482,  0.37594842,  0.64618203,
        0.91641563]))
train/val Accuracy = 0.60033099911 / 0.573529411765 
 with threshold: [[ 11.40343901]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812, 0.57609686188627585, 0.5266824072128734, 0.58693020543754182]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.03, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 1
============ epoch 0 ===========
training loss:		1.648821
||Xanchor-Xpos||_2  counter: 
[154310  17092   9694   6532   4564   3231   2122   1410    924    552
    360    194    106     70     21     14      8      4      0      1]
||Xanchor-Xneg||_2  counter: 
[152074  17830   9838   6728   4686   3478   2284   1636   1065    662
    421    221    151     65     35     17      7      7      2      2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   0.57271397   22.04293997   43.51316596   64.98339196   86.45361795
  107.92384395  129.39406995  150.86429594  172.33452194  193.80474793
  215.27497393  236.74519992  258.21542592  279.68565192  301.15587791
  322.62610391  344.0963299   365.5665559   387.0367819   408.50700789
  429.97723389]
distance difference  counter: 
(array([    3,     1,     0,     4,     5,     6,    17,    34,    53,
         118,   195,   292,   570,  1174,  2533,  6452, 18356, 71953,
       86707, 12736]), array([-7.58674479, -7.16034333, -6.73394187, -6.30754041, -5.88113896,
       -5.4547375 , -5.02833604, -4.60193458, -4.17553313, -3.74913167,
       -3.32273021, -2.89632876, -2.4699273 , -2.04352584, -1.61712438,
       -1.19072293, -0.76432147, -0.33792001,  0.08848144,  0.5148829 ,
        0.94128436]))
||Xanchor-Xpos||_2  counter: 
[ 3699 10202 10525  7626  4808  2831  1621   838   548   298   147    83
    41    39    12    18     4     6     2     1]
||Xanchor-Xneg||_2  counter: 
[1858 6474 9258 8427 6207 4272 2734 1646 1043  592  342  229  124   68   36
   17   14    4    4    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.14148483   1.47599803   2.81051124   4.14502445   5.47953765
   6.81405086   8.14856407   9.48307727  10.81759048  12.15210369
  13.48661689  14.8211301   16.15564331  17.49015651  18.82466972
  20.15918293  21.49369614  22.82820934  24.16272255  25.49723576
  26.83174896]
distance difference  counter: 
(array([    2,     7,     2,    12,     9,    13,    31,    48,    79,
         103,   210,   335,   564,  1095,  2093,  4208,  7905, 13903,
       10873,  1858]), array([-4.7207818 , -4.43643813, -4.15209447, -3.8677508 , -3.58340713,
       -3.29906346, -3.01471979, -2.73037612, -2.44603245, -2.16168878,
       -1.87734511, -1.59300145, -1.30865778, -1.02431411, -0.73997044,
       -0.45562677, -0.1712831 ,  0.11306057,  0.39740424,  0.6817479 ,
        0.96609157]))
train/val Accuracy = 0.505121540289 / 0.500011534025 
 with threshold: [[ 23.21138092]]
============ epoch 1 ===========
training loss:		1.639871
||Xanchor-Xpos||_2  counter: 
[15920 60655 55751 33278 17510  8977  4495  2310  1158   552   310   133
    93    26    21    14     4     2     0     0]
||Xanchor-Xneg||_2  counter: 
[ 6947 37634 50120 40633 26796 16565  9711  5611  3296  1832   988   520
   278   141    59    39    23     8     4     4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.43659168   2.33723124   4.23787079   6.13851035   8.0391499
   9.93978946  11.84042901  13.74106857  15.64170812  17.54234768
  19.44298723  21.34362679  23.24426634  25.1449059   27.04554545
  28.94618501  30.84682456  32.74746412  34.64810367  36.54874323
  38.44938278]
distance difference  counter: 
(array([    3,     2,     1,     4,     4,    12,    21,    37,    71,
         111,   204,   324,   653,  1331,  2975,  7259, 19327, 51066,
       92293, 25511]), array([-8.13478756, -7.68098392, -7.22718027, -6.77337663, -6.31957299,
       -5.86576934, -5.4119657 , -4.95816205, -4.50435841, -4.05055477,
       -3.59675112, -3.14294748, -2.68914384, -2.23534019, -1.78153655,
       -1.32773291, -0.87392926, -0.42012562,  0.03367803,  0.48748167,
        0.94128531]))
||Xanchor-Xpos||_2  counter: 
[ 3477  9151 10081  7643  5124  3310  1891  1108   667   379   224   114
    74    43    30    14     7     7     4     1]
||Xanchor-Xneg||_2  counter: 
[1687 5692 8448 8028 6532 4652 3150 1971 1199  824  458  306  183   95   59
   30   16   10    6    4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.18903816   1.44199899   2.69495982   3.94792065   5.20088148
   6.45384231   7.70680314   8.95976397  10.2127248   11.46568564
  12.71864647  13.9716073   15.22456813  16.47752896  17.73048979
  18.98345062  20.23641145  21.48937228  22.74233311  23.99529395
  25.24825478]
distance difference  counter: 
(array([    3,     2,     6,     9,     3,    16,    33,    55,    66,
          98,   190,   339,   626,  1123,  2147,  4239,  8150, 13910,
       10564,  1771]), array([-4.7119031 , -4.42792943, -4.14395577, -3.85998211, -3.57600845,
       -3.29203479, -3.00806113, -2.72408747, -2.44011381, -2.15614015,
       -1.87216648, -1.58819282, -1.30421916, -1.0202455 , -0.73627184,
       -0.45229818, -0.16832452,  0.11564914,  0.3996228 ,  0.68359646,
        0.96757013]))
train/val Accuracy = 0.592587806708 / 0.560703575548 
 with threshold: [[ 6.33579034]]
============ epoch 2 ===========
training loss:		1.639870
||Xanchor-Xpos||_2  counter: 
[15938 60662 55595 33674 17394  8863  4493  2264  1170   588   308   130
    65    37    14     7     4     1     2     0]
||Xanchor-Xneg||_2  counter: 
[ 7006 37305 50129 40782 27011 16481  9720  5656  3248  1790  1004   531
   273   139    68    37    16     7     4     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.42592016   2.32759111   4.22926206   6.13093301   8.03260396
   9.9342749   11.83594585  13.7376168   15.63928775  17.5409587
  19.44262965  21.3443006   23.24597155  25.1476425   27.04931345
  28.9509844   30.85265535  32.75432629  34.65599724  36.55766819
  38.45933914]
distance difference  counter: 
(array([    3,     2,     1,     3,     4,     8,    16,    29,    47,
          91,   157,   352,   614,  1273,  2701,  6766, 18976, 52146,
       95220, 22800]), array([-8.45949554, -7.98778214, -7.51606873, -7.04435533, -6.57264192,
       -6.10092852, -5.62921511, -5.1575017 , -4.6857883 , -4.21407489,
       -3.74236149, -3.27064808, -2.79893467, -2.32722127, -1.85550786,
       -1.38379446, -0.91208105, -0.44036765,  0.03134576,  0.50305917,
        0.97477257]))
||Xanchor-Xpos||_2  counter: 
[3243 8462 9854 7745 5483 3546 2108 1208  711  446  231  133   72   52   21
   16    6    6    4    2]
||Xanchor-Xneg||_2  counter: 
[1601 5050 7891 7995 6608 4922 3415 2209 1406  926  553  338  181  124   55
   40   19    9    6    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.25285622   1.37569258   2.49852893   3.62136528   4.74420164
   5.86703799   6.98987434   8.11271069   9.23554705  10.3583834
  11.48121975  12.60405611  13.72689246  14.84972881  15.97256517
  17.09540152  18.21823787  19.34107422  20.46391058  21.58674693
  22.70958328]
distance difference  counter: 
(array([    1,     0,     2,     2,     4,    15,    16,    35,    54,
          80,   123,   274,   505,   935,  1921,  3987,  7839, 14364,
       11304,  1889]), array([-4.81155109, -4.52267155, -4.233792  , -3.94491245, -3.65603291,
       -3.36715336, -3.07827381, -2.78939427, -2.50051472, -2.21163518,
       -1.92275563, -1.63387608, -1.34499654, -1.05611699, -0.76723744,
       -0.4783579 , -0.18947835,  0.0994012 ,  0.38828074,  0.67716029,
        0.96603984]))
train/val Accuracy = 0.592806484799 / 0.558846597463 
 with threshold: [[ 6.32769978]]
============ epoch 3 ===========
training loss:		1.639870
||Xanchor-Xpos||_2  counter: 
[15445 61019 56376 33492 17385  8691  4350  2238  1099   553   302   136
    63    40    12     2     3     1     1     1]
||Xanchor-Xneg||_2  counter: 
[ 6736 37651 50449 41145 26851 16455  9630  5456  3153  1705   936   481
   281   135    80    40    14     5     2     4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.3832427    2.30643972   4.22963675   6.15283378   8.0760308
   9.99922783  11.92242486  13.84562188  15.76881891  17.69201594
  19.61521296  21.53840999  23.46160702  25.38480404  27.30800107
  29.23119809  31.15439512  33.07759215  35.00078917  36.9239862
  38.84718323]
distance difference  counter: 
(array([    3,     0,     3,     3,     3,    10,    22,    30,    50,
         101,   171,   341,   593,  1229,  2665,  6635, 18270, 50568,
       95360, 25152]), array([-8.45719624, -7.98637301, -7.51554978, -7.04472656, -6.57390333,
       -6.10308011, -5.63225688, -5.16143366, -4.69061043, -4.21978721,
       -3.74896398, -3.27814076, -2.80731753, -2.33649431, -1.86567108,
       -1.39484785, -0.92402463, -0.4532014 ,  0.01762182,  0.48844505,
        0.95926827]))
||Xanchor-Xpos||_2  counter: 
[ 3844  9213 10084  7552  5097  3253  1842  1032   663   341   185    98
    67    34    22     7    10     5     1     0]
||Xanchor-Xneg||_2  counter: 
[1922 5847 8430 8087 6333 4649 3051 1973 1208  731  477  280  160  100   48
   26   16    5    4    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.30005202   1.50754564   2.71503926   3.92253288   5.13002651
   6.33752013   7.54501375   8.75250738   9.960001    11.16749462
  12.37498824  13.58248187  14.78997549  15.99746911  17.20496273
  18.41245636  19.61994998  20.8274436   22.03493722  23.24243085
  24.44992447]
distance difference  counter: 
(array([    1,     1,     1,     3,     9,     7,    14,    32,    47,
          86,   151,   246,   438,   863,  1717,  3537,  7207, 13930,
       12566,  2494]), array([-5.01430082, -4.7162549 , -4.41820898, -4.12016306, -3.82211714,
       -3.52407122, -3.2260253 , -2.92797937, -2.62993345, -2.33188753,
       -2.03384161, -1.73579569, -1.43774977, -1.13970385, -0.84165792,
       -0.543612  , -0.24556608,  0.05247984,  0.35052576,  0.64857168,
        0.9466176 ]))
train/val Accuracy = 0.593300995482 / 0.559746251442 
 with threshold: [[ 6.32934635]]
============ epoch 4 ===========
training loss:		1.639871
||Xanchor-Xpos||_2  counter: 
[16458 62429 55897 32947 16865  8341  4159  2072  1062   471   255   131
    70    26    14     3     6     1     1     1]
||Xanchor-Xneg||_2  counter: 
[ 7217 39142 50900 40699 26392 15806  9258  5365  2982  1679   836   464
   236   127    55    27    14     4     4     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.39779094   2.34851907   4.2992472    6.24997533   8.20070345
  10.15143158  12.10215971  14.05288784  16.00361597  17.9543441
  19.90507223  21.85580036  23.80652848  25.75725661  27.70798474
  29.65871287  31.609441    33.56016913  35.51089726  37.46162539
  39.41235352]
distance difference  counter: 
(array([    6,     5,     6,    10,    17,    18,    38,    67,   133,
         215,   367,   553,  1127,  2146,  4663, 10412, 25558, 58272,
       80172, 17424]), array([-7.07417536, -6.67333941, -6.27250347, -5.87166753, -5.47083158,
       -5.06999564, -4.6691597 , -4.26832376, -3.86748781, -3.46665187,
       -3.06581593, -2.66497998, -2.26414404, -1.8633081 , -1.46247215,
       -1.06163621, -0.66080027, -0.25996432,  0.14087162,  0.54170756,
        0.94254351]))
||Xanchor-Xpos||_2  counter: 
[ 3730 10191 10642  7733  4910  2828  1493   860   446   224   134    56
    49    18    17     8     4     4     2     0]
||Xanchor-Xneg||_2  counter: 
[1828 6150 9303 8556 6434 4443 2730 1645  987  581  297  200   91   50   23
   13   11    4    2    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.20959459   1.48757674   2.76555889   4.04354103   5.32152318
   6.59950532   7.87748747   9.15546962  10.43345176  11.71143391
  12.98941606  14.2673982   15.54538035  16.82336249  18.10134464
  19.37932679  20.65730893  21.93529108  23.21327323  24.49125537
  25.76923752]
distance difference  counter: 
(array([    1,     3,     1,     1,     8,    15,    24,    36,    65,
         102,   157,   321,   568,  1097,  2108,  4163,  7960, 14073,
       10739,  1908]), array([-4.61424065, -4.3360373 , -4.05783396, -3.77963061, -3.50142727,
       -3.22322392, -2.94502058, -2.66681724, -2.38861389, -2.11041055,
       -1.8322072 , -1.55400386, -1.27580051, -0.99759717, -0.71939383,
       -0.44119048, -0.16298714,  0.11521621,  0.39341955,  0.6716229 ,
        0.94982624]))
train/val Accuracy = 0.592689690819 / 0.561441753172 
 with threshold: [[ 6.33515594]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812, 0.57609686188627585, 0.5266824072128734, 0.58693020543754182, 0.57706572199542805]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.3, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 0.01
============ epoch 0 ===========
training loss:		0.017149
||Xanchor-Xpos||_2  counter: 
[ 5033 31676 47655 43505 31295 19500 11084  5981  2966  1430   631   274
   113    42    17     5     1     1     0     0]
||Xanchor-Xneg||_2  counter: 
[ 3081 25134 44352 44181 34067 22385 13401  7493  3833  1814   851   368
   162    50    19    11     5     1     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  11.70777798   38.64784379   65.5879096    92.52797542  119.46804123
  146.40810704  173.34817286  200.28823867  227.22830448  254.16837029
  281.10843611  308.04850192  334.98856773  361.92863355  388.86869936
  415.80876517  442.74883099  469.6888968   496.62896261  523.56902843
  550.50909424]
distance difference  counter: 
(array([     1,      0,      0,      4,      0,      1,      2,      5,
           11,     31,     38,     80,    214,    408,    943,   2374,
         7874,  42979, 139475,   6769]), array([-9.48745155, -8.96917183, -8.45089211, -7.93261239, -7.41433266,
       -6.89605294, -6.37777322, -5.8594935 , -5.34121377, -4.82293405,
       -4.30465433, -3.78637461, -3.26809489, -2.74981516, -2.23153544,
       -1.71325572, -1.194976  , -0.67669627, -0.15841655,  0.35986317,
        0.87814289]))
||Xanchor-Xpos||_2  counter: 
[1503 3931 5866 7058 6926 5989 4477 3088 1934 1190  651  330  201  101   45
   28   17    6    4    0]
||Xanchor-Xneg||_2  counter: 
[ 839 2678 4615 6021 6637 6309 5267 3770 2706 1789 1118  720  390  236  122
   55   41   19   13    5]
||Xanchor-X_neg/pos||_2  bins edge: 
[   5.32099771   13.56857774   21.81615777   30.0637378    38.31131783
   46.55889785   54.80647788   63.05405791   71.30163794   79.54921796
   87.79679799   96.04437802  104.29195805  112.53953807  120.7871181
  129.03469813  137.28227816  145.52985818  153.77743821  162.02501824
  170.27259827]
distance difference  counter: 
(array([    1,     0,     0,     2,     0,     3,     2,     4,    11,
          24,    32,    79,   131,   233,   442,  1171,  3440, 14065,
       22160,  1550]), array([-8.89013195, -8.39988487, -7.90963779, -7.41939071, -6.92914363,
       -6.43889655, -5.94864947, -5.45840239, -4.96815531, -4.47790823,
       -3.98766115, -3.49741407, -3.00716699, -2.51691991, -2.02667283,
       -1.53642575, -1.04617867, -0.55593159, -0.06568452,  0.42456256,
        0.91480964]))
train/val Accuracy = 0.528331237668 / 0.50291810842 
 with threshold: [[ 113.99627026]]
============ epoch 1 ===========
training loss:		0.016588
||Xanchor-Xpos||_2  counter: 
[ 2984 25884 44976 44138 33166 21788 13073  7307  3971  2045   986   493
   233    89    51    15     6     2     2     0]
||Xanchor-Xneg||_2  counter: 
[ 1535 18017 39436 43931 35647 25131 16034  9721  5431  3091  1586   849
   410   213    99    45    18    11     3     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   5.20416403   17.00872405   28.81328406   40.61784408   52.4224041
   64.22696412   76.03152413   87.83608415   99.64064417  111.44520419
  123.2497642   135.05432422  146.85888424  158.66344426  170.46800427
  182.27256429  194.07712431  205.88168433  217.68624434  229.49080436
  241.29536438]
distance difference  counter: 
(array([     1,      0,      0,      0,      1,      0,      0,      2,
            3,      6,     17,     45,     98,    196,    509,   1427,
         4561,  22337, 159069,  12937]), array([-11.41081047, -10.79522867, -10.17964687,  -9.56406507,
        -8.94848328,  -8.33290148,  -7.71731968,  -7.10173788,
        -6.48615608,  -5.87057428,  -5.25499249,  -4.63941069,
        -4.02382889,  -3.40824709,  -2.79266529,  -2.17708349,
        -1.56150169,  -0.9459199 ,  -0.3303381 ,   0.2852437 ,   0.9008255 ]))
||Xanchor-Xpos||_2  counter: 
[ 974 3253 5190 7231 7249 6542 4850 3298 2115 1285  692  337  177   74   44
   16   14    4    1    0]
||Xanchor-Xneg||_2  counter: 
[ 454 1941 3366 5564 6743 6618 5829 4249 3210 2121 1346  864  483  289  150
   59   41   11   10    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  2.45878339   6.46789187  10.47700036  14.48610884  18.49521732
  22.50432581  26.51343429  30.52254277  34.53165126  38.54075974
  42.54986823  46.55897671  50.56808519  54.57719368  58.58630216
  62.59541065  66.60451913  70.61362761  74.6227361   78.63184458
  82.64095306]
distance difference  counter: 
(array([    1,     0,     0,     1,     4,    10,    11,    21,    36,
          53,   105,   166,   347,   654,  1276,  3221,  8767, 21608,
        6574,   495]), array([-6.14655828, -5.79383005, -5.44110183, -5.0883736 , -4.73564537,
       -4.38291714, -4.03018891, -3.67746068, -3.32473245, -2.97200422,
       -2.61927599, -2.26654776, -1.91381953, -1.5610913 , -1.20836307,
       -0.85563484, -0.50290661, -0.15017838,  0.20254985,  0.55527808,
        0.90800631]))
train/val Accuracy = 0.536926777629 / 0.505409457901 
 with threshold: [[ 53.80645419]]
============ epoch 2 ===========
training loss:		0.016483
||Xanchor-Xpos||_2  counter: 
[ 1483 18958 44765 49660 38310 24025 13009  6192  2842  1183   459   201
    73    39     5     3     1     1     0     0]
||Xanchor-Xneg||_2  counter: 
[  635 10516 32745 45684 41797 30351 18925 10498  5402  2527  1248   528
   198    92    32    19     6     3     1     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   3.13956904    9.44836437   15.75715969   22.06595501   28.37475033
   34.68354565   40.99234097   47.30113629   53.60993161   59.91872693
   66.22752225   72.53631757   78.8451129    85.15390822   91.46270354
   97.77149886  104.08029418  110.3890895   116.69788482  123.00668014
  129.31547546]
distance difference  counter: 
(array([    1,     2,     1,     1,     2,     1,     7,     9,    20,
          34,    72,   141,   310,   717,  1709,  4505, 17485, 94482,
       79201,  2509]), array([-7.72513151, -7.29441682, -6.86370212, -6.43298742, -6.00227273,
       -5.57155803, -5.14084333, -4.71012864, -4.27941394, -3.84869924,
       -3.41798455, -2.98726985, -2.55655515, -2.12584046, -1.69512576,
       -1.26441106, -0.83369637, -0.40298167,  0.02773303,  0.45844772,
        0.88916242]))
||Xanchor-Xpos||_2  counter: 
[ 718 2914 4794 6914 7301 6791 5229 3660 2264 1373  721  366  169   74   31
   19    7    3    2    0]
||Xanchor-Xneg||_2  counter: 
[ 312 1465 2624 4522 6288 6774 6171 4690 3612 2507 1638 1147  692  437  238
  127   72   19   12    3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.8824147    4.6334945    7.38457431  10.13565411  12.88673391
  15.63781372  18.38889352  21.13997332  23.89105313  26.64213293
  29.39321274  32.14429254  34.89537234  37.64645215  40.39753195
  43.14861175  45.89969156  48.65077136  51.40185117  54.15293097
  56.90401077]
distance difference  counter: 
(array([    4,     1,     3,     8,    14,    23,    30,    49,    83,
         132,   268,   470,   776,  1459,  2927,  6217, 12885, 14684,
        3054,   263]), array([-4.80994034, -4.52426614, -4.23859194, -3.95291774, -3.66724354,
       -3.38156934, -3.09589514, -2.81022094, -2.52454674, -2.23887254,
       -1.95319834, -1.66752414, -1.38184994, -1.09617575, -0.81050155,
       -0.52482735, -0.23915315,  0.04652105,  0.33219525,  0.61786945,
        0.90354365]))
train/val Accuracy = 0.561843655105 / 0.533079584775 
 with threshold: [[ 29.75334453]]
============ epoch 3 ===========
training loss:		0.016466
||Xanchor-Xpos||_2  counter: 
[  671  9876 32508 46551 43727 31830 19008  9748  4366  1783   725   267
   114    19    13     2     1     0     0     0]
||Xanchor-Xneg||_2  counter: 
[  287  4374 18976 35225 41237 36501 27009 17318 10024  5383  2658  1214
   616   221   109    37    10     6     3     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  2.77360535   7.08160095  11.38959656  15.69759216  20.00558777
  24.31358337  28.62157898  32.92957458  37.23757019  41.5455658
  45.8535614   50.16155701  54.46955261  58.77754822  63.08554382
  67.39353943  71.70153503  76.00953064  80.31752625  84.62552185
  88.93351746]
distance difference  counter: 
(array([    3,     0,     3,     4,     8,    17,    20,    50,    79,
         128,   288,   520,  1173,  2517,  6279, 18962, 60294, 92400,
       17958,   506]), array([-5.51780224, -5.19719886, -4.87659548, -4.5559921 , -4.23538872,
       -3.91478534, -3.59418196, -3.27357858, -2.9529752 , -2.63237182,
       -2.31176844, -1.99116506, -1.67056168, -1.3499583 , -1.02935492,
       -0.70875154, -0.38814816, -0.06754479,  0.25305859,  0.57366197,
        0.89426535]))
||Xanchor-Xpos||_2  counter: 
[ 772 3250 5304 7280 7537 6571 5054 3377 1970 1150  556  286  137   56   29
   14    6    1    0    0]
||Xanchor-Xneg||_2  counter: 
[ 333 1589 2895 4693 6471 6990 5967 4774 3419 2328 1528 1026  630  376  159
   96   52   15    8    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.83186018   4.52334461   7.21482903   9.90631345  12.59779787
  15.28928229  17.98076671  20.67225114  23.36373556  26.05521998
  28.7467044   31.43818882  34.12967324  36.82115766  39.51264209
  42.20412651  44.89561093  47.58709535  50.27857977  52.97006419
  55.66154861]
distance difference  counter: 
(array([    1,     1,     4,    11,     7,    12,    30,    53,    73,
         131,   248,   388,   728,  1348,  2741,  5436, 11756, 16070,
        3961,   351]), array([ -5.07349348e+00,  -4.77479334e+00,  -4.47609320e+00,
        -4.17739305e+00,  -3.87869291e+00,  -3.57999277e+00,
        -3.28129263e+00,  -2.98259249e+00,  -2.68389235e+00,
        -2.38519220e+00,  -2.08649206e+00,  -1.78779192e+00,
        -1.48909178e+00,  -1.19039164e+00,  -8.91691494e-01,
        -5.92991352e-01,  -2.94291210e-01,   4.40893173e-03,
         3.03109074e-01,   6.01809216e-01,   9.00509357e-01]))
train/val Accuracy = 0.583209498581 / 0.560934256055 
 with threshold: [[ 23.60742517]]
============ epoch 4 ===========
training loss:		0.016463
||Xanchor-Xpos||_2  counter: 
[  439  6298 23994 39491 42410 35346 24464 14559  7778  3606  1660   676
   286   115    48    24    11     3     0     0]
||Xanchor-Xneg||_2  counter: 
[  199  2605 12216 26692 35451 36298 30570 22444 14914  9235  5154  2795
  1383   668   318   148    72    29    12     5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  2.82925034   6.52927723  10.22930412  13.92933102  17.62935791
  21.3293848   25.0294117   28.72943859  32.42946548  36.12949238
  39.82951927  43.52954617  47.22957306  50.92959995  54.62962685
  58.32965374  62.02968063  65.72970753  69.42973442  73.12976131
  76.82978821]
distance difference  counter: 
(array([    2,     3,     4,     5,     7,    20,    21,    38,    73,
         146,   237,   521,  1108,  2409,  6165, 18549, 55712, 92643,
       22746,   800]), array([-5.51985645, -5.20064273, -4.881429  , -4.56221528, -4.24300156,
       -3.92378783, -3.60457411, -3.28536038, -2.96614666, -2.64693294,
       -2.32771921, -2.00850549, -1.68929176, -1.37007804, -1.05086432,
       -0.73165059, -0.41243687, -0.09322314,  0.22599058,  0.54520431,
        0.86441803]))
||Xanchor-Xpos||_2  counter: 
[ 612 2921 4826 6874 7271 6649 5391 3697 2365 1364  677  384  172   84   38
   12    8    3    1    1]
||Xanchor-Xneg||_2  counter: 
[ 267 1382 2477 4283 5828 6757 6363 4924 3704 2637 1781 1172  788  464  265
  150   70   25   10    3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.81793773   4.37885473   6.93977174   9.50068874  12.06160574
  14.62252274  17.18343974  19.74435675  22.30527375  24.86619075
  27.42710775  29.98802475  32.54894176  35.10985876  37.67077576
  40.23169276  42.79260976  45.35352677  47.91444377  50.47536077
  53.03627777]
distance difference  counter: 
(array([    1,     4,     5,    10,    11,    18,    30,    54,    94,
         171,   303,   487,   897,  1631,  3216,  6208, 12662, 14090,
        3166,   292]), array([-4.75511217, -4.47249109, -4.18987   , -3.90724891, -3.62462783,
       -3.34200674, -3.05938566, -2.77676457, -2.49414349, -2.2115224 ,
       -1.92890131, -1.64628023, -1.36365914, -1.08103806, -0.79841697,
       -0.51579589, -0.2331748 ,  0.04944628,  0.33206737,  0.61468846,
        0.89730954]))
train/val Accuracy = 0.589272845648 / 0.565294117647 
 with threshold: [[ 22.80239783]]
============ epoch 5 ===========
training loss:		0.016462
||Xanchor-Xpos||_2  counter: 
[  501  6997 26680 43082 43819 34621 22467 12598  5922  2656  1146   438
   180    66    26     6     2     1     1     0]
||Xanchor-Xneg||_2  counter: 
[  207  2937 14089 28939 38232 37384 30149 20795 13198  7596  3966  2068
   911   429   191    62    36    13     5     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  2.71802211   6.58646137  10.45490062  14.32333988  18.19177914
  22.06021839  25.92865765  29.79709691  33.66553617  37.53397542
  41.40241468  45.27085394  49.13929319  53.00773245  56.87617171
  60.74461097  64.61305022  68.48148948  72.34992874  76.21836799
  80.08680725]
distance difference  counter: 
(array([     1,      0,      2,      3,      3,      3,      7,     24,
           35,     68,    125,    308,    638,   1475,   3886,  12533,
        43620, 102338,  35142,    998]), array([-6.28628016, -5.92764768, -5.56901521, -5.21038274, -4.85175027,
       -4.49311779, -4.13448532, -3.77585285, -3.41722038, -3.05858791,
       -2.69995543, -2.34132296, -1.98269049, -1.62405802, -1.26542554,
       -0.90679307, -0.5481606 , -0.18952813,  0.16910434,  0.52773682,
        0.88636929]))
||Xanchor-Xpos||_2  counter: 
[ 977 3874 6527 8482 7989 6497 4339 2464 1247  580  228   90   32   16    4
    1    3    0    0    0]
||Xanchor-Xneg||_2  counter: 
[ 437 1882 3603 6018 7645 7471 5915 4094 2613 1618 1032  524  264  145   61
   17   10    0    0    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.96585095   4.85480797   7.74376498  10.632722    13.52167902
  16.41063604  19.29959306  22.18855007  25.07750709  27.96646411
  30.85542113  33.74437814  36.63333516  39.52229218  42.4112492
  45.30020621  48.18916323  51.07812025  53.96707727  56.85603428
  59.7449913 ]
distance difference  counter: 
(array([    2,     2,     3,     6,     9,    17,    23,    44,    83,
         125,   244,   455,   796,  1578,  3042,  6075, 12431, 14782,
        3354,   279]), array([-4.7754035 , -4.49216819, -4.20893288, -3.92569757, -3.64246227,
       -3.35922696, -3.07599165, -2.79275634, -2.50952103, -2.22628572,
       -1.94305041, -1.65981511, -1.3765798 , -1.09334449, -0.81010918,
       -0.52687387, -0.24363856,  0.03959675,  0.32283205,  0.60606736,
        0.88930267]))
train/val Accuracy = 0.591683274605 / 0.562537485582 
 with threshold: [[ 22.75471865]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812, 0.57609686188627585, 0.5266824072128734, 0.58693020543754182, 0.57706572199542805, 0.57728348164755816]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.3, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 0.1
============ epoch 0 ===========
training loss:		0.164987
||Xanchor-Xpos||_2  counter: 
[158332  17960   9682   6119   3758   2313   1453    813    415    212
     97     26     16      8      2      2      1      0      0      0]
||Xanchor-Xneg||_2  counter: 
[154450  20032  10078   6397   4130   2610   1633    911    501    255
    115     60     17     11      5      3      0      0      0      1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   0.99832398   28.15297016   55.30761634   82.46226251  109.61690869
  136.77155487  163.92620105  191.08084723  218.23549341  245.39013959
  272.54478577  299.69943195  326.85407813  354.00872431  381.16337048
  408.31801666  435.47266284  462.62730902  489.7819552   516.93660138
  544.09124756]
distance difference  counter: 
(array([    2,     0,     1,     1,     2,     3,     2,    13,    10,
          29,    69,   170,   289,   650,  1570,  4324, 15632, 72687,
       99775,  5980]), array([ -8.14220142e+00,  -7.68968147e+00,  -7.23716152e+00,
        -6.78464156e+00,  -6.33212161e+00,  -5.87960166e+00,
        -5.42708170e+00,  -4.97456175e+00,  -4.52204180e+00,
        -4.06952184e+00,  -3.61700189e+00,  -3.16448194e+00,
        -2.71196198e+00,  -2.25944203e+00,  -1.80692208e+00,
        -1.35440212e+00,  -9.01882172e-01,  -4.49362218e-01,
         3.15773487e-03,   4.55677688e-01,   9.08197641e-01]))
||Xanchor-Xpos||_2  counter: 
[1596 5594 8778 9076 7137 4931 2908 1627  855  424  226  105   56   27    4
    3    3    0    0    0]
||Xanchor-Xneg||_2  counter: 
[ 725 2857 5959 7874 7814 6211 4354 2883 1861 1245  714  393  221  124   63
   26   19    5    0    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.83441687   2.91166937   4.98892188   7.06617439   9.1434269
  11.2206794   13.29793191  15.37518442  17.45243692  19.52968943
  21.60694194  23.68419445  25.76144695  27.83869946  29.91595197
  31.99320447  34.07045698  36.14770949  38.224962    40.3022145
  42.37946701]
distance difference  counter: 
(array([    4,     4,     4,     7,     9,    18,    23,    56,    69,
         121,   193,   392,   732,  1277,  2539,  5150, 10537, 15387,
        6272,   556]), array([-4.99649763, -4.70019298, -4.40388834, -4.10758369, -3.81127905,
       -3.5149744 , -3.21866975, -2.92236511, -2.62606046, -2.32975582,
       -2.03345117, -1.73714652, -1.44084188, -1.14453723, -0.84823259,
       -0.55192794, -0.25562329,  0.04068135,  0.336986  ,  0.63329065,
        0.92959529]))
train/val Accuracy = 0.510131256554 / 0.502376009227 
 with threshold: [[ 27.76251582]]
============ epoch 1 ===========
training loss:		0.164102
||Xanchor-Xpos||_2  counter: 
[ 2471 25407 51271 50512 34903 19639  9520  4251  1839   798   354   136
    55    25    20     6     1     0     0     1]
||Xanchor-Xneg||_2  counter: 
[ 1020 12351 34038 44623 40289 28817 18070 10525  5656  2990  1468   737
   336   160    62    38    14     9     3     3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.29842603   4.0101832    6.72194036   9.43369753  12.14545469
  14.85721186  17.56896902  20.28072619  22.99248335  25.70424052
  28.41599768  31.12775485  33.83951201  36.55126918  39.26302634
  41.97478351  44.68654068  47.39829784  50.11005501  52.82181217
  55.53356934]
distance difference  counter: 
(array([    2,     4,     1,     2,    11,    13,    17,    42,    63,
         122,   201,   434,   876,  1740,  4338, 11856, 35992, 85412,
       56482,  3601]), array([-6.37952709, -6.01604328, -5.65255947, -5.28907566, -4.92559185,
       -4.56210804, -4.19862423, -3.83514042, -3.47165661, -3.1081728 ,
       -2.74468899, -2.38120518, -2.01772137, -1.65423756, -1.29075375,
       -0.92726994, -0.56378613, -0.20030231,  0.1631815 ,  0.52666531,
        0.89014912]))
||Xanchor-Xpos||_2  counter: 
[2039 6899 9807 9053 6478 4177 2332 1234  649  324  167  105   35   27   12
    8    1    2    0    0]
||Xanchor-Xneg||_2  counter: 
[ 969 3505 7096 8601 7616 5590 3873 2462 1522  985  510  319  155   77   40
   20    4    4    1    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.90064061   3.18717043   5.47370025   7.76023007  10.04675989
  12.33328971  14.61981953  16.90634935  19.19287918  21.479409
  23.76593882  26.05246864  28.33899846  30.62552828  32.9120581
  35.19858792  37.48511775  39.77164757  42.05817739  44.34470721
  46.63123703]
distance difference  counter: 
(array([    2,    10,     7,     6,    17,    27,    31,    54,    88,
         177,   242,   427,   741,  1385,  2747,  5175,  9991, 15165,
        6386,   672]), array([-5.02221537, -4.7247066 , -4.42719784, -4.12968907, -3.83218031,
       -3.53467155, -3.23716278, -2.93965402, -2.64214525, -2.34463649,
       -2.04712772, -1.74961896, -1.4521102 , -1.15460143, -0.85709267,
       -0.5595839 , -0.26207514,  0.03543363,  0.33294239,  0.63045115,
        0.92795992]))
train/val Accuracy = 0.593569373139 / 0.575513264129 
 with threshold: [[ 12.25067947]]
============ epoch 2 ===========
training loss:		0.164103
||Xanchor-Xpos||_2  counter: 
[ 2076 24437 51087 50992 35485 19775  9607  4463  1956   776   312   134
    62    24    15     5     1     1     1     0]
||Xanchor-Xneg||_2  counter: 
[  795 11758 33640 44848 40811 29022 18504 10561  5603  2945  1497   652
   320   132    55    34    19     5     3     5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.1281507    3.86839386   6.60863702   9.34888018  12.08912334
  14.82936651  17.56960967  20.30985283  23.05009599  25.79033915
  28.53058231  31.27082547  34.01106863  36.75131179  39.49155495
  42.23179811  44.97204127  47.71228443  50.45252759  53.19277076
  55.93301392]
distance difference  counter: 
(array([    2,     2,     0,     2,     2,     5,    12,    22,    40,
          62,   135,   246,   554,  1277,  2869,  8321, 29059, 84690,
       69898,  4011]), array([-7.23412895, -6.82590845, -6.41768794, -6.00946743, -5.60124693,
       -5.19302642, -4.78480592, -4.37658541, -3.96836491, -3.5601444 ,
       -3.15192389, -2.74370339, -2.33548288, -1.92726238, -1.51904187,
       -1.11082137, -0.70260086, -0.29438035,  0.11384015,  0.52206066,
        0.93028116]))
||Xanchor-Xpos||_2  counter: 
[1441 5532 8715 8951 7278 5025 2959 1677  909  453  243   96   36   17   13
    3    1    0    0    1]
||Xanchor-Xneg||_2  counter: 
[ 673 2683 5665 7890 7792 6291 4594 3003 1998 1249  731  361  227  102   44
   33   11    2    0    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.82953763   2.79201239   4.75448716   6.71696192   8.67943668
  10.64191145  12.60438621  14.56686097  16.52933574  18.4918105
  20.45428526  22.41676003  24.37923479  26.34170955  28.30418432
  30.26665908  32.22913384  34.19160861  36.15408337  38.11655813
  40.0790329 ]
distance difference  counter: 
(array([    2,     1,     1,     4,     4,    10,    11,    28,    40,
          89,   156,   282,   517,  1069,  2175,  4566,  9691, 16609,
        7445,   650]), array([ -5.29306984e+00,  -4.98195943e+00,  -4.67084903e+00,
        -4.35973862e+00,  -4.04862821e+00,  -3.73751780e+00,
        -3.42640740e+00,  -3.11529699e+00,  -2.80418658e+00,
        -2.49307618e+00,  -2.18196577e+00,  -1.87085536e+00,
        -1.55974495e+00,  -1.24863455e+00,  -9.37524140e-01,
        -6.26413733e-01,  -3.15303326e-01,  -4.19291854e-03,
         3.06917489e-01,   6.18027896e-01,   9.29138303e-01]))
train/val Accuracy = 0.593355665005 / 0.571326412918 
 with threshold: [[ 12.25524883]]
============ epoch 3 ===========
training loss:		0.164102
||Xanchor-Xpos||_2  counter: 
[ 2933 29392 55214 50491 32362 17164  7935  3379  1408   556   244    78
    26    17     4     3     0     1     1     1]
||Xanchor-Xneg||_2  counter: 
[ 1181 14601 37814 47317 39403 27096 16059  8931  4630  2235  1069   487
   210    95    46    16     9     6     3     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.25480568   4.10962254   6.9644394    9.81925626  12.67407312
  15.52888998  18.38370684  21.2385237   24.09334056  26.94815742
  29.80297428  32.65779114  35.512608    38.36742486  41.22224172
  44.07705858  46.93187544  49.7866923   52.64150916  55.49632602
  58.35114288]
distance difference  counter: 
(array([    1,     0,     0,     2,     1,     1,     1,     3,    20,
          34,    73,   119,   307,   695,  1634,  4737, 17954, 68694,
       98932,  8001]), array([-8.38363075, -7.91849811, -7.45336547, -6.98823284, -6.5231002 ,
       -6.05796756, -5.59283492, -5.12770228, -4.66256964, -4.197437  ,
       -3.73230436, -3.26717173, -2.80203909, -2.33690645, -1.87177381,
       -1.40664117, -0.94150853, -0.47637589, -0.01124325,  0.45388938,
        0.91902202]))
||Xanchor-Xpos||_2  counter: 
[1833 6079 9198 9054 7011 4513 2620 1471  763  407  180  125   51   24    9
    7    3    2    0    0]
||Xanchor-Xneg||_2  counter: 
[ 886 3159 6366 8221 7687 5941 4140 2834 1798 1052  616  323  178   75   37
   22    8    4    1    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.79530406   2.89213382   4.98896358   7.08579334   9.1826231
  11.27945286  13.37628262  15.47311238  17.56994214  19.6667719
  21.76360166  23.86043142  25.95726118  28.05409094  30.1509207
  32.24775046  34.34458022  36.44140998  38.53823974  40.6350695
  42.73189926]
distance difference  counter: 
(array([    1,     1,     3,     1,     0,     6,    12,    14,    36,
          56,    99,   185,   329,   729,  1504,  3343,  7641, 16591,
       11568,  1231]), array([-6.05549288, -5.70697471, -5.35845653, -5.00993836, -4.66142019,
       -4.31290202, -3.96438385, -3.61586567, -3.2673475 , -2.91882933,
       -2.57031116, -2.22179299, -1.87327482, -1.52475664, -1.17623847,
       -0.8277203 , -0.47920213, -0.13068396,  0.21783422,  0.56635239,
        0.91487056]))
train/val Accuracy = 0.593360634962 / 0.572722029988 
 with threshold: [[ 12.24589337]]
============ epoch 4 ===========
training loss:		0.164103
||Xanchor-Xpos||_2  counter: 
[ 4907 42276 64009 47692 24948 10852  4076  1545   562   210    95    22
    12     2     0     1     0     0     0     0]
||Xanchor-Xneg||_2  counter: 
[ 2042 22762 49400 50612 35983 20936 10627  4981  2252   962   381   168
    56    29    12     4     0     1     0     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  1.28424442   4.54659241   7.8089404   11.07128839  14.33363638
  17.59598437  20.85833236  24.12068035  27.38302834  30.64537633
  33.90772432  37.17007231  40.4324203   43.69476829  46.95711628
  50.21946427  53.48181226  56.74416025  60.00650824  63.26885623
  66.53120422]
distance difference  counter: 
(array([     1,      0,      0,      1,      0,      0,      2,      2,
            5,     19,     36,     73,    164,    419,   1022,   3027,
        11358,  53568, 118123,  13389]), array([-9.51319695, -8.99155475, -8.46991256, -7.94827037, -7.42662817,
       -6.90498598, -6.38334379, -5.86170159, -5.3400594 , -4.81841721,
       -4.29677501, -3.77513282, -3.25349063, -2.73184843, -2.21020624,
       -1.68856405, -1.16692185, -0.64527966, -0.12363747,  0.39800473,
        0.91964692]))
||Xanchor-Xpos||_2  counter: 
[1299 4711 7807 8789 7521 5443 3568 2061 1088  549  285  128   48   37   12
    4    0    0    0    0]
||Xanchor-Xneg||_2  counter: 
[ 595 2294 4729 7197 7677 6492 4884 3479 2258 1416  921  594  377  222  115
   62   24    8    3    2]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.8558315    2.61519275   4.374554     6.13391525   7.8932765
   9.65263775  11.411999    13.17136025  14.9307215   16.69008275
  18.449444    20.20880525  21.96816649  23.72752774  25.48688899
  27.24625024  29.00561149  30.76497274  32.52433399  34.28369524
  36.04305649]
distance difference  counter: 
(array([    1,     0,     0,     0,     1,     0,     3,     6,    20,
          33,    58,   154,   283,   621,  1346,  3140,  7239, 16836,
       12507,  1102]), array([-6.18569231, -5.83070709, -5.47572186, -5.12073663, -4.76575141,
       -4.41076618, -4.05578096, -3.70079573, -3.34581051, -2.99082528,
       -2.63584006, -2.28085483, -1.92586961, -1.57088438, -1.21589916,
       -0.86091393, -0.50592871, -0.15094348,  0.20404174,  0.55902697,
        0.91401219]))
train/val Accuracy = 0.593221476177 / 0.569192618224 
 with threshold: [[ 12.27064878]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812, 0.57609686188627585, 0.5266824072128734, 0.58693020543754182, 0.57706572199542805, 0.57728348164755816, 0.58454131863427683]
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/005_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/006_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/016_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/018_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/019_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/021_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/036_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/037_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/038_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/042_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/045_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/049_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/050_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/059_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/061_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/062_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/063_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/066_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/085_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/089_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/093_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/096_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/097_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/100_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/103_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/104_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/105_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/124_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/128_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_train.shape=(735009, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_train.shape=(603627, 3, 64, 64)
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/017_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/031_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/084_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/102_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/125_hard_inputs.data
loaded: /home/mengqi/dataset/MVS/lasagne/save_inputs_target_2views_triplet/126_hard_inputs.data
before filterOutNearPurePatches_4D, triplet_stack_val.shape=(148986, 3, 64, 64)
after filterOutNearPurePatches_4D, triplet_stack_val.shape=(130050, 3, 64, 64)
lr_coefficient of previous layers: 0
loaded the weight: /home/mengqi/dataset/MVS/lasagne/save_model_2views_triplet/vgg16.pkl
learning rate: 0.3, batch size: 1500, triplet_alpha: 2, shuffle_sample_ON: True, weight_decay: 1
============ epoch 0 ===========
training loss:		1.640510
||Xanchor-Xpos||_2  counter: 
[189420   8465   1084    489    374    273    233    209    159    132
    134     91     49     28     29     17      7      8      5      1]
||Xanchor-Xneg||_2  counter: 
[181696  15163   1939    537    382    279    220    220    176    156
    146     95     78     52     20     26     13      4      3      4]
||Xanchor-X_neg/pos||_2  bins edge: 
[  3.60078007e-01   1.99326625e+01   3.95052470e+01   5.90778314e+01
   7.86504159e+01   9.82230004e+01   1.17795585e+02   1.37368169e+02
   1.56940754e+02   1.76513338e+02   1.96085923e+02   2.15658507e+02
   2.35231092e+02   2.54803676e+02   2.74376261e+02   2.93948845e+02
   3.13521430e+02   3.33094014e+02   3.52666599e+02   3.72239183e+02
   3.91811768e+02]
distance difference  counter: 
(array([     1,      0,      0,      0,      1,      0,      1,      4,
            2,      9,     10,     26,     35,    132,    246,    657,
         1812,   6948,  43059, 148266]), array([-22.68667793, -21.50475394, -20.32282994, -19.14090594,
       -17.95898194, -16.77705795, -15.59513395, -14.41320995,
       -13.23128595, -12.04936196, -10.86743796,  -9.68551396,
        -8.50358996,  -7.32166597,  -6.13974197,  -4.95781797,
        -3.77589397,  -2.59396998,  -1.41204598,  -0.23012198,   0.95180202]))
||Xanchor-Xpos||_2  counter: 
[3213 8096 9689 8001 5822 3644 2136 1246  698  384  211  115   47   23   14
    6    5    0    0    0]
||Xanchor-Xneg||_2  counter: 
[1808 5466 8038 7924 6434 4666 3198 2100 1339  931  570  358  222  128   68
   51   23   10    7    8]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.26886061   1.3545978    2.44033499   3.52607218   4.61180937
   5.69754656   6.78328376   7.86902095   8.95475814  10.04049533
  11.12623252  12.21196971  13.2977069   14.38344409  15.46918128
  16.55491848  17.64065567  18.72639286  19.81213005  20.89786724
  21.98360443]
distance difference  counter: 
(array([    1,     1,     1,     4,     1,     5,     6,    12,    22,
          56,   107,   183,   353,   688,  1305,  2898,  6613, 14153,
       14039,  2902]), array([-5.20011091, -4.89232971, -4.5845485 , -4.2767673 , -3.96898609,
       -3.66120489, -3.35342368, -3.04564248, -2.73786128, -2.43008007,
       -2.12229887, -1.81451766, -1.50673646, -1.19895525, -0.89117405,
       -0.58339284, -0.27561164,  0.03216957,  0.33995077,  0.64773197,
        0.95551318]))
train/val Accuracy = 0.551461415742 / 0.519642445213 
 with threshold: [[ 9.76321761]]
============ epoch 1 ===========
training loss:		1.639259
||Xanchor-Xpos||_2  counter: 
[77585 73305 26782 11609  5677  2936  1546   845   410   252   136    60
    30    16    12     5     2     1     0     0]
||Xanchor-Xneg||_2  counter: 
[52988 75042 34837 16419  9094  5203  3060  1878  1142   673   385   225
   108    67    44    21     8     9     1     5]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.35045204   4.66972295   8.98899387  13.30826478  17.6275357
  21.94680662  26.26607753  30.58534845  34.90461937  39.22389028
  43.5431612   47.86243211  52.18170303  56.50097395  60.82024486
  65.13951578  69.4587867   73.77805761  78.09732853  82.41659945
  86.73587036]
distance difference  counter: 
(array([     1,      0,      0,      1,      0,      6,      8,     12,
           22,     20,     49,     68,    137,    255,    555,   1333,
         3697,  12713,  64695, 117637]), array([ -1.82708836e+01,  -1.73083365e+01,  -1.63457894e+01,
        -1.53832423e+01,  -1.44206952e+01,  -1.34581481e+01,
        -1.24956011e+01,  -1.15330540e+01,  -1.05705069e+01,
        -9.60795980e+00,  -8.64541271e+00,  -7.68286563e+00,
        -6.72031854e+00,  -5.75777146e+00,  -4.79522437e+00,
        -3.83267729e+00,  -2.87013021e+00,  -1.90758312e+00,
        -9.45036036e-01,   1.75110489e-02,   9.80058134e-01]))
||Xanchor-Xpos||_2  counter: 
[ 5982 11992 10064  6503  3797  2077  1334   642   416   251   124    87
    37    20    15     4     3     1     1     0]
||Xanchor-Xneg||_2  counter: 
[3784 9694 9718 7164 4814 3187 2002 1203  730  457  265  132  104   37   25
   19    7    5    2    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.43684903   2.9721145    5.50737998   8.04264545  10.57791092
  13.1131764   15.64844187  18.18370735  20.71897282  23.25423829
  25.78950377  28.32476924  30.86003472  33.39530019  35.93056566
  38.46583114  41.00109661  43.53636209  46.07162756  48.60689303
  51.14215851]
distance difference  counter: 
(array([    1,     0,     0,     0,     1,     1,     2,     2,    10,
           7,    29,    54,    96,   167,   350,   905,  2190,  6701,
       20320, 12514]), array([-11.20060062, -10.59263256,  -9.98466449,  -9.37669643,
        -8.76872836,  -8.1607603 ,  -7.55279223,  -6.94482417,
        -6.3368561 ,  -5.72888804,  -5.12091997,  -4.51295191,
        -3.90498384,  -3.29701578,  -2.68904771,  -2.08107965,
        -1.47311158,  -0.86514352,  -0.25717545,   0.35079261,   0.95876068]))
train/val Accuracy = 0.561329264596 / 0.555928489043 
 with threshold: [[ 8.19544396]]
============ epoch 2 ===========
training loss:		1.639260
||Xanchor-Xpos||_2  counter: 
[94899 69384 21273  8359  3863  1711   857   414   202   122    60    32
    16     5     7     3     1     1     0     0]
||Xanchor-Xneg||_2  counter: 
[68748 75332 29736 13058  6556  3484  1946  1084   573   326   176    83
    48    23    18     9     4     3     1     1]
||Xanchor-X_neg/pos||_2  bins edge: 
[   0.30617464    5.37683049   10.44748634   15.51814219   20.58879805
   25.6594539    30.73010975   35.8007656    40.87142146   45.94207731
   51.01273316   56.08338901   61.15404487   66.22470072   71.29535657
   76.36601242   81.43666828   86.50732413   91.57797998   96.64863583
  101.71929169]
distance difference  counter: 
(array([     2,      1,      0,      1,      5,      8,      6,     11,
           22,     38,     73,    106,    166,    369,    731,   1667,
         4641,  15295,  72515, 105552]), array([-16.53039742, -15.65523657, -14.78007572, -13.90491487,
       -13.02975402, -12.15459317, -11.27943232, -10.40427147,
        -9.52911062,  -8.65394977,  -7.77878892,  -6.90362808,
        -6.02846723,  -5.15330638,  -4.27814553,  -3.40298468,
        -2.52782383,  -1.65266298,  -0.77750213,   0.09765872,   0.97281957]))
||Xanchor-Xpos||_2  counter: 
[ 4338  9967 10166  7486  4838  2838  1674   902   516   277   169    92
    42    22    12     5     3     3     0     0]
||Xanchor-Xneg||_2  counter: 
[2495 7376 9195 7516 5684 4082 2658 1723 1090  704  377  200  119   74   26
   23    4    2    0    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.32002023   1.73638511   3.15274999   4.56911488   5.98547976
   7.40184464   8.81820953  10.23457441  11.65093929  13.06730417
  14.48366906  15.90003394  17.31639882  18.73276371  20.14912859
  21.56549347  22.98185835  24.39822324  25.81458812  27.230953
  28.64731789]
distance difference  counter: 
(array([    1,     1,     1,     3,     2,     7,    16,    18,    42,
          61,   104,   220,   383,   695,  1377,  2932,  6462, 13469,
       14280,  3276]), array([-5.48380804, -5.1622953 , -4.84078256, -4.51926982, -4.19775708,
       -3.87624434, -3.5547316 , -3.23321885, -2.91170611, -2.59019337,
       -2.26868063, -1.94716789, -1.62565515, -1.30414241, -0.98262967,
       -0.66111693, -0.33960419, -0.01809145,  0.30342129,  0.62493404,
        0.94644678]))
train/val Accuracy = 0.561970388999 / 0.545340253749 
 with threshold: [[ 8.11484556]]
============ epoch 3 ===========
training loss:		1.639258
||Xanchor-Xpos||_2  counter: 
[94442 69459 21565  8337  3870  1804   872   426   226    86    69    21
    11    10     5     2     3     0     0     1]
||Xanchor-Xneg||_2  counter: 
[68057 75739 29894 13138  6482  3557  1926  1124   580   337   192    85
    45    21    16     6     3     2     3     2]
||Xanchor-X_neg/pos||_2  bins edge: 
[   0.32224074    5.34813615   10.37403156   15.39992697   20.42582238
   25.45171779   30.4776132    35.50350861   40.52940401   45.55529942
   50.58119483   55.60709024   60.63298565   65.65888106   70.68477647
   75.71067188   80.73656729   85.7624627    90.78835811   95.81425352
  100.84014893]
distance difference  counter: 
(array([    2,     2,     2,     7,     2,     8,    14,    16,    31,
          49,    92,   136,   235,   477,   992,  2134,  5519, 17993,
       78708, 94790]), array([-15.21014404, -14.40127171, -13.59239938, -12.78352704,
       -11.97465471, -11.16578238, -10.35691004,  -9.54803771,
        -8.73916538,  -7.93029304,  -7.12142071,  -6.31254838,
        -5.50367604,  -4.69480371,  -3.88593138,  -3.07705905,
        -2.26818671,  -1.45931438,  -0.65044205,   0.15843029,   0.96730262]))
||Xanchor-Xpos||_2  counter: 
[3009 8271 9863 8213 5601 3541 2048 1187  707  415  228  120   74   32   21
    7    5    3    2    2]
||Xanchor-Xneg||_2  counter: 
[1725 5870 8403 7955 6242 4556 3086 2051 1325  889  529  320  189   97   50
   27   18   11    6    1]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.36555186   1.81115557   3.25675928   4.70236299   6.14796669
   7.5935704    9.03917411  10.48477782  11.93038153  13.37598524
  14.82158895  16.26719266  17.71279637  19.15840008  20.60400378
  22.04960749  23.4952112   24.94081491  26.38641862  27.83202233
  29.27762604]
distance difference  counter: 
(array([    4,     3,     4,     6,    17,    12,    33,    52,    70,
         139,   199,   362,   642,  1210,  2362,  4612,  8725, 13722,
        9633,  1543]), array([-4.5049324 , -4.23250156, -3.96007072, -3.68763987, -3.41520903,
       -3.14277819, -2.87034734, -2.5979165 , -2.32548566, -2.05305482,
       -1.78062397, -1.50819313, -1.23576229, -0.96333144, -0.6909006 ,
       -0.41846976, -0.14603891,  0.12639193,  0.39882277,  0.67125362,
        0.94368446]))
train/val Accuracy = 0.562531994096 / 0.550634371396 
 with threshold: [[ 8.09246889]]
============ epoch 4 ===========
training loss:		1.639259
||Xanchor-Xpos||_2  counter: 
[82282 74494 24983 10036  4696  2344  1164   612   282   154    72    42
    27    10     4     1     6     0     0     0]
||Xanchor-Xneg||_2  counter: 
[57099 77594 33383 15149  7834  4368  2488  1461   823   448   242   140
    91    32    27     9    10     6     2     3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.21992145   4.86342291   9.50692437  14.15042582  18.79392728
  23.43742873  28.08093019  32.72443164  37.3679331   42.01143455
  46.65493601  51.29843746  55.94193892  60.58544037  65.22894183
  69.87244328  74.51594474  79.1594462   83.80294765  88.44644911
  93.08995056]
distance difference  counter: 
(array([     1,      0,      6,      0,      5,      4,      7,     11,
           20,     28,     50,     93,    187,    346,    704,   1544,
         4332,  14319,  69863, 109689]), array([-17.0276947 , -16.12781315, -15.22793161, -14.32805006,
       -13.42816851, -12.52828696, -11.62840542, -10.72852387,
        -9.82864232,  -8.92876077,  -8.02887923,  -7.12899768,
        -6.22911613,  -5.32923458,  -4.42935303,  -3.52947149,
        -2.62958994,  -1.72970839,  -0.82982684,   0.0700547 ,   0.96993625]))
||Xanchor-Xpos||_2  counter: 
[ 6223 13033 10163  5865  3442  1893  1139   687   369   223   141    78
    46    33     8     4     1     1     1     0]
||Xanchor-Xneg||_2  counter: 
[ 3857 10690  9960  7051  4452  2701  1721  1090   700   429   276   181
    96    71    35    19     9     7     2     3]
||Xanchor-X_neg/pos||_2  bins edge: 
[  0.32138416   3.52604097   6.73069777   9.93535458  13.14001138
  16.34466819  19.54932499  22.7539818   25.9586386   29.16329541
  32.36795221  35.57260902  38.77726582  41.98192263  45.18657943
  48.39123624  51.59589304  54.80054985  58.00520665  61.20986346
  64.41452026]
distance difference  counter: 
(array([    3,     0,     2,     8,     2,     8,    11,    21,    32,
          43,    77,   127,   229,   353,   719,  1450,  3340,  8567,
       19816,  8542]), array([-9.65059185, -9.12034411, -8.59009636, -8.05984862, -7.52960087,
       -6.99935313, -6.46910538, -5.93885764, -5.40860989, -4.87836215,
       -4.3481144 , -3.81786666, -3.28761891, -2.75737117, -2.22712342,
       -1.69687568, -1.16662793, -0.63638019, -0.10613244,  0.4241153 ,
        0.95436305]))
train/val Accuracy = 0.562238766656 / 0.558339100346 
 with threshold: [[ 8.10922576]]
untile now, the train_val_mean_acc: [0.52416200747565167, 0.52227295754946812, 0.57609686188627585, 0.5266824072128734, 0.58693020543754182, 0.57706572199542805, 0.57728348164755816, 0.58454131863427683, 0.5602889335007939]
.VGGface_MVS-train.sh.1: line 8: .: filename argument required
.: usage: . filename [arguments]
Done

----------------- end -----------------
Sat Oct  1 17:59:30 CEST 2016
elapsed time: 007:07:57
---------------------------------------
